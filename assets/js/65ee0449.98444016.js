"use strict";(self.webpackChunkdata_platform_playbook=self.webpackChunkdata_platform_playbook||[]).push([[743],{7688:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>l});var n=t(4848),i=t(8453);const s={title:"Ingesting data from Google Sheets",layout:"playbook_js",tags:["playbook"]},r=void 0,o={id:"playbook/ingesting-data/google-sheets-import",title:"Ingesting data from Google Sheets",description:"Objective",source:"@site/docs/playbook/ingesting-data/002-google-sheets-import.md",sourceDirName:"playbook/ingesting-data",slug:"/playbook/ingesting-data/google-sheets-import",permalink:"/Data-Platform-Playbook/playbook/ingesting-data/google-sheets-import",draft:!1,unlisted:!1,editUrl:"https://github.com/LBHackney-IT/data-platform-playbook/edit/master/docs/playbook/ingesting-data/002-google-sheets-import.md",tags:[{inline:!0,label:"playbook",permalink:"/Data-Platform-Playbook/tags/playbook"}],version:"current",sidebarPosition:2,frontMatter:{title:"Ingesting data from Google Sheets",layout:"playbook_js",tags:["playbook"]},sidebar:"docs",previous:{title:"Types of data and ingestion process",permalink:"/Data-Platform-Playbook/playbook/ingesting-data/what-data-are-we-ingesting"},next:{title:"Ingest manually uploaded csv files",permalink:"/Data-Platform-Playbook/playbook/ingesting-data/manual-ingest-of-csv-files"}},c={},l=[{value:"Objective",id:"objective",level:2},{value:"Intended audience",id:"intended-audience",level:2},{value:"Preparing a Google Sheet for Ingestion",id:"preparing-a-google-sheet-for-ingestion",level:3},{value:"Departmental Service Email Addresses and YAML Files",id:"departmental-service-email-addresses-and-yaml-files",level:3},{value:"How to Edit the YAML File",id:"how-to-edit-the-yaml-file",level:3},{value:"Steps:",id:"steps",level:4}];function d(e){const a={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.h2,{id:"objective",children:"Objective"}),"\n",(0,n.jsx)(a.p,{children:"Ingest data contained within a Google Sheet for use on the Data Platform, optionally setting a recurring schedule to ingest new data."}),"\n",(0,n.jsx)(a.h2,{id:"intended-audience",children:"Intended audience"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsx)(a.li,{children:"Data Analyst"}),"\n"]}),"\n",(0,n.jsx)(a.h3,{id:"preparing-a-google-sheet-for-ingestion",children:"Preparing a Google Sheet for Ingestion"}),"\n",(0,n.jsx)(a.p,{children:"To ensure a Google Sheet is ready for ingestion, follow these steps:"}),"\n",(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Open the Google Sheet"})," you want to ingest."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Ensure all columns have headers"})," \u2013 Columns without headers will be ignored."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Name the document"})," if it is currently unnamed."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsxs)(a.strong,{children:["Remove ",(0,n.jsx)(a.code,{children:"restricted"})," tag"]})," on the sheet."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Share the sheet"})," with the appropriate service account emails:","\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:["Click ",(0,n.jsx)(a.code,{children:"Share"})," in the top right corner."]}),"\n",(0,n.jsxs)(a.li,{children:["Enter the two service email addresses (found in the table below) and set their access to ",(0,n.jsx)(a.code,{children:"Viewer"}),"."]}),"\n",(0,n.jsxs)(a.li,{children:["Uncheck the ",(0,n.jsx)(a.code,{children:"Notify people"})," box."]}),"\n",(0,n.jsxs)(a.li,{children:["Click ",(0,n.jsx)(a.code,{children:"Share"}),". If prompted to confirm sharing outside your organisation, click ",(0,n.jsx)(a.code,{children:"Share anyway"}),"."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Edit the YAML file"})," as described below. If your department does not have a YAML file, contact the DAP team for configuration assistance."]}),"\n",(0,n.jsx)(a.li,{children:(0,n.jsx)(a.strong,{children:"Your Google Sheet is now ready for ingestion."})}),"\n"]}),"\n",(0,n.jsx)(a.hr,{}),"\n",(0,n.jsx)(a.h3,{id:"departmental-service-email-addresses-and-yaml-files",children:"Departmental Service Email Addresses and YAML Files"}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Department"}),(0,n.jsx)(a.th,{children:"Staging Service Account Email"}),(0,n.jsx)(a.th,{children:"Production Service Account Email"}),(0,n.jsx)(a.th,{children:"YAML File URL"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Parking"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:parking@dataplatform-stg.iam.gserviceaccount.com",children:"parking@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:parking@dataplatform-prod0.iam.gserviceaccount.com",children:"parking@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"https://github.com/LBHackney-IT/dap-airflow/blob/main/airflow/dags/parking/google_sheet_ingestion_config/parking.yaml",children:"Link"})})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Housing Repairs"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:housing-repairs@dataplatform-stg.iam.gserviceaccount.com",children:"housing-repairs@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:housing-repairs@dataplatform-prod0.iam.gserviceaccount.com",children:"housing-repairs@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Data & Insight"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:data-and-insight@dataplatform-stg.iam.gserviceaccount.com",children:"data-and-insight@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:data-and-insight@dataplatform-prod0.iam.gserviceaccount.com",children:"data-and-insight@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"https://github.com/LBHackney-IT/dap-airflow/blob/main/airflow/dags/data_and_insight/google_sheet_ingestion_config/data_and_insight.yaml",children:"Link"})})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Finance"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:finance@dataplatform-stg.iam.gserviceaccount.com",children:"finance@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:finance@dataplatform-prod0.iam.gserviceaccount.com",children:"finance@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Environmental Enforcement"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:env-enforcement@dataplatform-stg.iam.gserviceaccount.com",children:"env-enforcement@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:env-enforcement@dataplatform-prod0.iam.gserviceaccount.com",children:"env-enforcement@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Planning"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:planning@dataplatform-stg.iam.gserviceaccount.com",children:"planning@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:planning@dataplatform-prod0.iam.gserviceaccount.com",children:"planning@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Unrestricted"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:unrestricted@dataplatform-stg.iam.gserviceaccount.com",children:"unrestricted@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:unrestricted@dataplatform-prod0.iam.gserviceaccount.com",children:"unrestricted@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Sandbox"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:sandbox@dataplatform-stg.iam.gserviceaccount.com",children:"sandbox@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:sandbox@dataplatform-prod0.iam.gserviceaccount.com",children:"sandbox@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Benefits & Housing Needs"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:benefits-housing-needs@dataplatform-stg.iam.gserviceaccount.com",children:"benefits-housing-needs@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:benefits-housing-needs@dataplatform-prod0.iam.gserviceaccount.com",children:"benefits-housing-needs@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Revenues"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:revenues@dataplatform-stg.iam.gserviceaccount.com",children:"revenues@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:revenues@dataplatform-prod0.iam.gserviceaccount.com",children:"revenues@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Environmental Services"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:environmental-services@dataplatform-stg.iam.gserviceaccount.com",children:"environmental-services@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:environmental-services@dataplatform-prod0.iam.gserviceaccount.com",children:"environmental-services@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Housing"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:housing@dataplatform-stg.iam.gserviceaccount.com",children:"housing@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:housing@dataplatform-prod0.iam.gserviceaccount.com",children:"housing@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"https://github.com/LBHackney-IT/dap-airflow/blob/main/airflow/dags/housing/google_sheet_ingestion_config/housing.yaml",children:"Link"})})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Child & Family Services"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:child-fam-services@dataplatform-prod0.iam.gserviceaccount.com",children:"child-fam-services@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:child-fam-services@dataplatform-stg.iam.gserviceaccount.com",children:"child-fam-services@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"https://github.com/LBHackney-IT/dap-airflow/blob/main/airflow/dags/child_fam_services/google_sheet_ingestion_config/child_fam_services.yaml",children:"Link"})})]})]})]}),"\n",(0,n.jsx)(a.h3,{id:"how-to-edit-the-yaml-file",children:"How to Edit the YAML File"}),"\n",(0,n.jsxs)(a.p,{children:["To configure data ingestion for a new sheet, follow these steps using ",(0,n.jsx)(a.strong,{children:"parking"})," as an example. This process ensures that the sheet is correctly mapped in the YAML file."]}),"\n",(0,n.jsx)(a.h4,{id:"steps",children:"Steps:"}),"\n",(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.strong,{children:"Locate the YAML file"})}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:["Open the relevant YAML file (e.g., ",(0,n.jsx)(a.code,{children:"parking.yaml"}),")."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.strong,{children:"Append the following configuration"})}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsx)(a.li,{children:"Scroll to the end of the file."}),"\n",(0,n.jsx)(a.li,{children:"Copy and paste the following details, replacing values where necessary:"}),"\n"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-yaml",children:"- department: parking\n  spreadsheet_title: nas_live_manual_updates_data_load\n  sheet_name: nas_live_manual_updates_data_load\n  sheet_id: 1Xf8nBhIW6wyvNOU7JOWSCJwZvsx65T9ZWYSct9vj9Gw\n  target_table: nas_live_manual_updates_data_load\n  pause_flag:\n"})}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.strong,{children:"Modify the parameters"})}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:(0,n.jsx)(a.code,{children:"department"})}),": Define the department to which the data belongs."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:(0,n.jsx)(a.code,{children:"spreadsheet_title"})}),": (Optional) A human-readable name for easy identification."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:(0,n.jsx)(a.code,{children:"sheet_name"})}),": Specify the name of the sheet in the Google Spreadsheet."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:(0,n.jsx)(a.code,{children:"sheet_id"})}),": Enter the unique Google Spreadsheet identifier."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:(0,n.jsx)(a.code,{children:"target_table"})}),": Define the table name in the raw zone database (The table name in the raw zone database will be same as target_table specified here and it's not mandatory to add department name in the table name)."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:(0,n.jsx)(a.code,{children:"pause_flag"})}),": Leave blank for scheduled ingestion or set to ",(0,n.jsx)(a.code,{children:"True"})," to pause."]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:a}={...(0,i.R)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453:(e,a,t)=>{t.d(a,{R:()=>r,x:()=>o});var n=t(6540);const i={},s=n.createContext(i);function r(e){const a=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(s.Provider,{value:a},e.children)}}}]);