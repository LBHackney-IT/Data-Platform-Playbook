"use strict";(self.webpackChunkdata_platform_playbook=self.webpackChunkdata_platform_playbook||[]).push([[2977],{3905:function(e,t,o){o.d(t,{Zo:function(){return u},kt:function(){return m}});var n=o(7294);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,n,a=function(e,t){if(null==e)return{};var o,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var l=n.createContext({}),p=function(e){var t=n.useContext(l),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},u=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var o=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),h=p(o),m=a,k=h["".concat(l,".").concat(m)]||h[m]||c[m]||r;return o?n.createElement(k,i(i({ref:t},u),{},{components:o})):n.createElement(k,i({ref:t},u))}));function m(e,t){var o=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=o.length,i=new Array(r);i[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var p=2;p<r;p++)i[p]=o[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,o)}h.displayName="MDXCreateElement"},9114:function(e,t,o){o.r(t),o.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return s},metadata:function(){return p},toc:function(){return c}});var n=o(3117),a=o(102),r=(o(7294),o(3905)),i=["components"],s={id:"using-sagemaker",title:"Prototyping glue jobs in a notebook",description:"Prototyping transformation scripts using a Jupyter Notebook",layout:"playbook_js",tags:["playbook"]},l=void 0,p={unversionedId:"playbook/transforming-data/using-aws-glue/using-sagemaker",id:"playbook/transforming-data/using-aws-glue/using-sagemaker",title:"Prototyping glue jobs in a notebook",description:"Prototyping transformation scripts using a Jupyter Notebook",source:"@site/docs/playbook/transforming-data/using-aws-glue/006-using-sagemaker.md",sourceDirName:"playbook/transforming-data/using-aws-glue",slug:"/playbook/transforming-data/using-aws-glue/using-sagemaker",permalink:"/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/using-sagemaker",draft:!1,editUrl:"https://github.com/LBHackney-IT/data-platform-playbook/edit/master/docs/playbook/transforming-data/using-aws-glue/006-using-sagemaker.md",tags:[{label:"playbook",permalink:"/Data-Platform-Playbook/tags/playbook"}],version:"current",sidebarPosition:6,frontMatter:{id:"using-sagemaker",title:"Prototyping glue jobs in a notebook",description:"Prototyping transformation scripts using a Jupyter Notebook",layout:"playbook_js",tags:["playbook"]},sidebar:"docs",previous:{title:"Deploying Glue jobs to the Data Platform",permalink:"/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/deploy-glue-jobs"},next:{title:"Scheduling Liberator Glue Jobs",permalink:"/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/practical-examples/scheduling-liberator-glue-jobs"}},u={},c=[{value:"Prototyping glue jobs in a Jupyter notebook",id:"prototyping-glue-jobs-in-a-jupyter-notebook",level:2},{value:"To start up a notebook",id:"to-start-up-a-notebook",level:3},{value:"Using a notebook",id:"using-a-notebook",level:3},{value:"Saving changes to the notebook scripts",id:"saving-changes-to-the-notebook-scripts",level:2},{value:"Helpful resources",id:"helpful-resources",level:2}],h={toc:c};function m(e){var t=e.components,s=(0,a.Z)(e,i);return(0,r.kt)("wrapper",(0,n.Z)({},h,s,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"prototyping-glue-jobs-in-a-jupyter-notebook"},"Prototyping glue jobs in a Jupyter notebook"),(0,r.kt)("p",null,"This guide explains how to connect to a notebook instance using AWS Sagemaker and also some tips for using the notebook.\nWe use notebooks to prototype transformation scripts before they are run and scheduled in AWS Glue."),(0,r.kt)("h3",{id:"to-start-up-a-notebook"},"To start up a notebook"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Login to AWS using the ",(0,r.kt)("a",{parentName:"li",href:"https://hackney.awsapps.com/start/#/"},"Hackney SSO portal"),"."),(0,r.kt)("li",{parentName:"ol"},'Search "Amazon SageMaker" and then navigate to the ',(0,r.kt)("a",{parentName:"li",href:"https://eu-west-2.console.aws.amazon.com/sagemaker/home?region=eu-west-2#/notebook-instances"},"Notebook Instances")," under the ",(0,r.kt)("strong",{parentName:"li"},"Notebook")," section in the left-hand panel of the Amazon SageMaker console."),(0,r.kt)("li",{parentName:"ol"},"Find the notebook appended by your department name, for example ",(0,r.kt)("inlineCode",{parentName:"li"},"sagemaker-notebook-parking"),".\nIf you can't see a notebook for your department then please contact the Data Platform team to request one."),(0,r.kt)("li",{parentName:"ol"},"If the Status of the notebook is ",(0,r.kt)("inlineCode",{parentName:"li"},"InService"),", go on the step 5.\nIf not, click ",(0,r.kt)("inlineCode",{parentName:"li"},"Start")," under the ",(0,r.kt)("strong",{parentName:"li"},"Actions")," column. ",(0,r.kt)("img",{alt:"start_notebook.png",src:o(5753).Z,width:"2238",height:"422"}),"\nThe notebook will then go to ",(0,r.kt)("inlineCode",{parentName:"li"},"Pending")," status, if this is the first time the notebook has been used that day it will take around 10 minutes to start up."),(0,r.kt)("li",{parentName:"ol"},"Once the Status of the notebook has changed to ",(0,r.kt)("inlineCode",{parentName:"li"},"InService"),", click the ",(0,r.kt)("a",{parentName:"li",href:"https://jupyterlab.readthedocs.io/en/stable/"},"JupyterLab")," link in the ",(0,r.kt)("strong",{parentName:"li"},"Actions")," column to open up the notebook.")),(0,r.kt)("h3",{id:"using-a-notebook"},"Using a notebook"),(0,r.kt)("p",null,"There is a ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/LBHackney-IT/Data-Platform-Notebooks"},"Github repository")," which will be preloaded into the notebook.\nThis is where we store any notebooks scripts that we want to keep.\nIf you want to keep the changes you have made to any scripts you must commit the changes to this repository otherwise you may lose your work."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"You should work in the folder ",(0,r.kt)("strong",{parentName:"p"},'"Data-Platform-Notebooks/notebooks"'),", where all the notebooks are stored.\nClick into this folder if you aren't already in there."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"notebook_folders.png",src:o(6152).Z,width:"378",height:"174"}))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Always start by pulling any latest changes from this repository.\nTo do this, click on the Github icon on the left panel and then select the icon to pull the latest changes, as shown below."),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"git_pull_in_jupyter_lab.png",src:o(8204).Z,width:"524",height:"438"}))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"There are a few templates in the ",(0,r.kt)("strong",{parentName:"p"},"templates")," folder that you can copy and paste into your departments folder and then use as a starting point.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Commit your changes by following the next section when you have finished working, so you don't lose your work."))),(0,r.kt)("h2",{id:"saving-changes-to-the-notebook-scripts"},"Saving changes to the notebook scripts"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"To authenticate with your Github account you need to create a personal access token.\nThese are needed when two factor authentication is enabled, which the Hackney Github organisation enforces.\nTo create your personal access token you can follow ",(0,r.kt)("a",{parentName:"p",href:"https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token#creating-a-token"},"this Github guide"),".\nOnce you have created it, you can store somewhere securely and keep re using for as long as the expiration period that you set up.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Before commiting, you need to ensure all the outputs from any scripts you\'ve edited have been cleared. This is to prevent any data being stored in Github.\nTo do so you need to open each script you\'ve been working on, then click on "Edit" then "Clear all Outputs".')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"To add changes to the commit, navigate to the Github tab on the left panel.\nThere you will see a list of changed files & untracked files.\nThe changed files are any that you have changed since the last commit and the untracked files are files which have been added since the last commit.\nYou can add any files you want to commit by hovering over the file and clicking on the plus sign.\nWhen you do this the file will move to the Staged section, this lists all the changes that will be commiting. ")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'When you have added all the files you want to commit to staged you can write a Summary & Description then click "Commit". You will then be promted for your name and email address, fill these in using your Hackney email.')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"The push your changes by clicking on the small cloud icon with an up arrow, as shown below.\nYou'll be prompted to enter your github username and a password.",(0,r.kt)("br",{parentName:"p"}),"\n","In the password box you should paste in the personal access token created in the first step."),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("img",{alt:"jupyter_push_icon.png",src:o(2667).Z,width:"696",height:"209"})))),(0,r.kt)("h2",{id:"helpful-resources"},"Helpful resources"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://jupyterlab.readthedocs.io/en/stable/"},"JupyterLab documentation")," "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://jupyter-notebook.readthedocs.io/en/latest/"},"Jupyter documentation")),(0,r.kt)("li",{parentName:"ul"},"The sparkmagic pyspark kernel that we use in the notebook has a few ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/jupyter-incubator/sparkmagic/blob/master/examples/Pyspark%20Kernel.ipynb"},"helpful functions."))))}m.isMDXComponent=!0},8204:function(e,t,o){t.Z=o.p+"assets/images/git_pull_in_jupyter_lab-05d54ace3e0a5ac7557a4aa05d02f722.png"},2667:function(e,t,o){t.Z=o.p+"assets/images/jupyter_push_icon-e2b49d986e240ae403d48933d57809eb.png"},6152:function(e,t,o){t.Z=o.p+"assets/images/notebook_folders-3ab7ee0731beef0b2a0bf0edd1597364.png"},5753:function(e,t,o){t.Z=o.p+"assets/images/start_notebook-2eec2f4d3f18e628402611b69b2bb6c4.png"}}]);