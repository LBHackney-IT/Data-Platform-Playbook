"use strict";(self.webpackChunkdata_platform_playbook=self.webpackChunkdata_platform_playbook||[]).push([[9918],{9058:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var n=t(4848),i=t(8453);const r={title:"Export data catalog table or view to Google Sheets",layout:"playbook_js",tags:["playbook"]},s=void 0,o={id:"playbook/exporting-data/save-glue-catalog-to-google-sheet",title:"Export data catalog table or view to Google Sheets",description:"Objective",source:"@site/docs/playbook/exporting-data/001-save-glue-catalog-to-google-sheet.md",sourceDirName:"playbook/exporting-data",slug:"/playbook/exporting-data/save-glue-catalog-to-google-sheet",permalink:"/Data-Platform-Playbook/playbook/exporting-data/save-glue-catalog-to-google-sheet",draft:!1,unlisted:!1,editUrl:"https://github.com/LBHackney-IT/data-platform-playbook/edit/master/docs/playbook/exporting-data/001-save-glue-catalog-to-google-sheet.md",tags:[{inline:!0,label:"playbook",permalink:"/Data-Platform-Playbook/tags/playbook"}],version:"current",sidebarPosition:1,frontMatter:{title:"Export data catalog table or view to Google Sheets",layout:"playbook_js",tags:["playbook"]},sidebar:"docs",previous:{title:"CSV files to Glue Catalog automation",permalink:"/Data-Platform-Playbook/playbook/ingesting-data/CSV-files-to-Glue-Catalog-automation"},next:{title:"Guide to testing data quality in Glue Jobs",permalink:"/Data-Platform-Playbook/playbook/transforming-data/guides-to-testing-in-the-platform/data-quality-testing-guide"}},c={},l=[{value:"Objective",id:"objective",level:2},{value:"Intended audience",id:"intended-audience",level:2},{value:"Preparing a Google Sheet for Export",id:"preparing-a-google-sheet-for-export",level:3},{value:"Departmental Service Email Addresses and YAML Files",id:"departmental-service-email-addresses-and-yaml-files",level:3},{value:"Configuration Parameters",id:"configuration-parameters",level:4},{value:"Important Notes",id:"important-notes",level:4},{value:"Example Configuration",id:"example-configuration",level:4}];function d(e){const a={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.h2,{id:"objective",children:"Objective"}),"\n",(0,n.jsx)(a.p,{children:"Export data catalog table or view from AWS Glue to Google Sheets, allowing you to share and analyze data in a spreadsheet format."}),"\n",(0,n.jsx)(a.h2,{id:"intended-audience",children:"Intended audience"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsx)(a.li,{children:"Data Analyst"}),"\n"]}),"\n",(0,n.jsx)(a.h3,{id:"preparing-a-google-sheet-for-export",children:"Preparing a Google Sheet for Export"}),"\n",(0,n.jsx)(a.p,{children:"To ensure a Google Sheet is ready to receive exported table or view data, follow these steps:"}),"\n",(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Create or open the Google Sheet"})," where you want to export the data."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Create your worksheet"})," in the sheet with the desired name."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsxs)(a.strong,{children:["Remove ",(0,n.jsx)(a.code,{children:"restricted"})," tag"]})," on the sheet."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Share the sheet"})," with the appropriate service account emails:","\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:["Click ",(0,n.jsx)(a.code,{children:"Share"})," in the top right corner."]}),"\n",(0,n.jsxs)(a.li,{children:["Enter the two service email addresses (found in the table below) and set their access to ",(0,n.jsx)(a.code,{children:"Editor"})," (required for writing data to the sheet)."]}),"\n",(0,n.jsxs)(a.li,{children:["Uncheck the ",(0,n.jsx)(a.code,{children:"Notify people"})," box."]}),"\n",(0,n.jsxs)(a.li,{children:["Click ",(0,n.jsx)(a.code,{children:"Share"}),". If prompted to confirm sharing outside your organisation, click ",(0,n.jsx)(a.code,{children:"Share anyway"}),"."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Add your sheet information to the configuration file"})," as described below."]}),"\n",(0,n.jsx)(a.li,{children:(0,n.jsx)(a.strong,{children:"Your Google Sheet is now ready to receive exported table or view data."})}),"\n"]}),"\n",(0,n.jsx)(a.hr,{}),"\n",(0,n.jsx)(a.h3,{id:"departmental-service-email-addresses-and-yaml-files",children:"Departmental Service Email Addresses and YAML Files"}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Department"}),(0,n.jsx)(a.th,{children:"Staging Service Account Email"}),(0,n.jsx)(a.th,{children:"Production Service Account Email"}),(0,n.jsx)(a.th,{children:"YAML File URL"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Parking"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:parking@dataplatform-stg.iam.gserviceaccount.com",children:"parking@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:parking@dataplatform-prod0.iam.gserviceaccount.com",children:"parking@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"https://github.com/LBHackney-IT/dap-airflow/blob/main/airflow/dags/parking/google_sheet_ingestion_config/parking.yaml",children:"Link"})})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Housing Repairs"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:housing-repairs@dataplatform-stg.iam.gserviceaccount.com",children:"housing-repairs@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:housing-repairs@dataplatform-prod0.iam.gserviceaccount.com",children:"housing-repairs@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Data & Insight"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:data-and-insight@dataplatform-stg.iam.gserviceaccount.com",children:"data-and-insight@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:data-and-insight@dataplatform-prod0.iam.gserviceaccount.com",children:"data-and-insight@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"https://github.com/LBHackney-IT/dap-airflow/blob/main/airflow/dags/data_and_insight/google_sheet_ingestion_config/data_and_insight.yaml",children:"Link"})})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Finance"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:finance@dataplatform-stg.iam.gserviceaccount.com",children:"finance@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:finance@dataplatform-prod0.iam.gserviceaccount.com",children:"finance@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Environmental Enforcement"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:env-enforcement@dataplatform-stg.iam.gserviceaccount.com",children:"env-enforcement@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:env-enforcement@dataplatform-prod0.iam.gserviceaccount.com",children:"env-enforcement@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Planning"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:planning@dataplatform-stg.iam.gserviceaccount.com",children:"planning@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:planning@dataplatform-prod0.iam.gserviceaccount.com",children:"planning@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Unrestricted"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:unrestricted@dataplatform-stg.iam.gserviceaccount.com",children:"unrestricted@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:unrestricted@dataplatform-prod0.iam.gserviceaccount.com",children:"unrestricted@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Sandbox"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:sandbox@dataplatform-stg.iam.gserviceaccount.com",children:"sandbox@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:sandbox@dataplatform-prod0.iam.gserviceaccount.com",children:"sandbox@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Benefits & Housing Needs"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:benefits-housing-needs@dataplatform-stg.iam.gserviceaccount.com",children:"benefits-housing-needs@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:benefits-housing-needs@dataplatform-prod0.iam.gserviceaccount.com",children:"benefits-housing-needs@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Revenues"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:revenues@dataplatform-stg.iam.gserviceaccount.com",children:"revenues@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:revenues@dataplatform-prod0.iam.gserviceaccount.com",children:"revenues@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Environmental Services"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:environmental-services@dataplatform-stg.iam.gserviceaccount.com",children:"environmental-services@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:environmental-services@dataplatform-prod0.iam.gserviceaccount.com",children:"environmental-services@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Housing"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:housing@dataplatform-stg.iam.gserviceaccount.com",children:"housing@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:housing@dataplatform-prod0.iam.gserviceaccount.com",children:"housing@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"https://github.com/LBHackney-IT/dap-airflow/blob/main/airflow/dags/housing/google_sheet_ingestion_config/housing.yaml",children:"Link"})})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Child & Family Services"}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:child-fam-services@dataplatform-stg.iam.gserviceaccount.com",children:"child-fam-services@dataplatform-stg.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"mailto:child-fam-services@dataplatform-prod0.iam.gserviceaccount.com",children:"child-fam-services@dataplatform-prod0.iam.gserviceaccount.com"})}),(0,n.jsx)(a.td,{children:(0,n.jsx)(a.a,{href:"https://github.com/LBHackney-IT/dap-airflow/blob/main/airflow/dags/child_fam_services/google_sheet_ingestion_config/child_fam_services.yaml",children:"Link"})})]})]})]}),"\n",(0,n.jsx)(a.h4,{id:"configuration-parameters",children:"Configuration Parameters"}),"\n",(0,n.jsx)(a.p,{children:"Each sheet export configuration can include the following parameters:"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:(0,n.jsx)(a.code,{children:"sheet_id"})}),": The unique identifier for the Google Sheet (required)"]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:(0,n.jsx)(a.code,{children:"worksheet_name"})}),": The name of the worksheet within the Google Sheet where data will be exported (required)"]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:(0,n.jsx)(a.code,{children:"glue_database"})}),": The database name in Glue data catalog (required)"]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:(0,n.jsx)(a.code,{children:"glue_table"})}),": The table or view name in the Glue database (required)"]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:(0,n.jsx)(a.code,{children:"custom_query"})}),": (Optional) Custom SQL query to filter the catalog data before export.","\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:["By default, it's empty and means ",(0,n.jsx)(a.code,{children:"SELECT * FROM glue_database.glue_table"})]}),"\n",(0,n.jsxs)(a.li,{children:["Cannot be used together with ",(0,n.jsx)(a.code,{children:"only_latest_partition"})]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:(0,n.jsx)(a.code,{children:"only_latest_partition"})}),": (Optional) Boolean (",(0,n.jsx)(a.code,{children:"true"}),"/",(0,n.jsx)(a.code,{children:"false"}),"). Only allow to be ",(0,n.jsx)(a.code,{children:"true"})," if table is partitioned by import_date. When ",(0,n.jsx)(a.code,{children:"true"}),", automatically generates a query to get only the latest partition based on ",(0,n.jsx)(a.code,{children:"import_date"}),":","\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:'SELECT * FROM "database"."table" WHERE import_date = (SELECT MAX(import_date) FROM "database"."table")\n'})}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:["Cannot be used together with ",(0,n.jsx)(a.code,{children:"custom_query"}),". By default, it's ",(0,n.jsx)(a.code,{children:"false"}),"."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:(0,n.jsx)(a.code,{children:"sheet_schedule"})}),": (Optional) Schedule for this specific sheet export within the DAG run.","\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsx)(a.li,{children:"If not specified, the task runs daily."}),"\n",(0,n.jsx)(a.li,{children:"If you want to export more than once a day, you still need to talk to the DAP to do some config behind the scenes."}),"\n",(0,n.jsxs)(a.li,{children:["Format: cron expression (e.g., ",(0,n.jsx)(a.code,{children:'"30 3 * * 5"'})," for Friday at 3:30 AM)"]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:(0,n.jsx)(a.code,{children:"header_case"})}),": (Optional) Case format for column headers in the exported sheet.","\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:["By default, it's ",(0,n.jsx)(a.code,{children:"original"})," (no transformation - headers remain as ",(0,n.jsx)(a.code,{children:"user_name"}),")"]}),"\n",(0,n.jsxs)(a.li,{children:["Available options with examples (for column ",(0,n.jsx)(a.code,{children:"user_name"}),"):","\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:"original"}),": ",(0,n.jsx)(a.code,{children:"user_name"})," (no transformation)"]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:"snake_case"}),": ",(0,n.jsx)(a.code,{children:"user_name"})]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:"camelCase"}),": ",(0,n.jsx)(a.code,{children:"userName"})]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:"PascalCase"}),": ",(0,n.jsx)(a.code,{children:"UserName"})]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:"kebab-case"}),": ",(0,n.jsx)(a.code,{children:"user-name"})]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:"UPPER_SNAKE_CASE"}),": ",(0,n.jsx)(a.code,{children:"USER_NAME"})]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:"lower"}),": ",(0,n.jsx)(a.code,{children:"user_name"})]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:"upper"}),": ",(0,n.jsx)(a.code,{children:"USER_NAME"})]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:"title"}),": ",(0,n.jsx)(a.code,{children:"User Name"})]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:"capitalize"}),": ",(0,n.jsx)(a.code,{children:"User name"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(a.h4,{id:"important-notes",children:"Important Notes"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:["Use either ",(0,n.jsx)(a.code,{children:"custom_query"})," OR ",(0,n.jsx)(a.code,{children:"only_latest_partition"}),", not both."]}),"\n"]}),"\n",(0,n.jsx)(a.h4,{id:"example-configuration",children:"Example Configuration"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-yaml",children:'# Example for non-partitioned table or view\nsheets:\n  - sheet_id: 1qgRT9GTSJw9DzJAazbLcN1sjIkqNXEMOMWaQD6m79M0\n    worksheet_name: Flat Table\n    glue_database: housing_nec_migration\n    glue_table: homeowners_flat_database\n# Example for custom query\n  - sheet_id: 1InRDSKgMGYuuhAB8huORD_mZVZKADuuVNM-egsZ_7hc\n    worksheet_name: cfs_test1\n    glue_database: child-fam-services-refined-zone\n    glue_table: addresses\n    custom_query: SELECT id, flat_number, post_code FROM "child-fam-services-raw-zone"."addresses" where street = \'Essex Road\'\n    sheet_schedule: 30 3 * * 5\n# Example for partitioned table\n  - sheet_id: 1InRDSKgMGYuuhAB8huORD_mZVZKADuuVNM-egsZ_7hc\n    worksheet_name: cfs_test2\n    glue_database: child-fam-services-refined-zone\n    glue_table: open_cin_cases_vs_supervisions\n    only_latest_partition: true\n# Example with header_case formatting\n  - sheet_id: 1InRDSKgMGYuuhAB8huORD_mZVZKADuuVNM-egsZ_7hc\n    worksheet_name: housing_test\n    glue_database: housing-raw-zone\n    glue_table: housing_officer_patch_mapping\n    only_latest_partition: true\n    header_case: title  # Transforms column headers like "user_name" to "User Name"\n'})})]})}function h(e={}){const{wrapper:a}={...(0,i.R)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453:(e,a,t)=>{t.d(a,{R:()=>s,x:()=>o});var n=t(6540);const i={},r=n.createContext(i);function s(e){const a=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),n.createElement(r.Provider,{value:a},e.children)}}}]);