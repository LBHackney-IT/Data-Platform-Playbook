"use strict";(self.webpackChunkdata_platform_playbook=self.webpackChunkdata_platform_playbook||[]).push([[4772],{3905:function(e,t,r){r.d(t,{Zo:function(){return d},kt:function(){return m}});var a=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var c=a.createContext({}),l=function(e){var t=a.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},d=function(e){var t=l(e.components);return a.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,c=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=l(r),m=n,f=p["".concat(c,".").concat(m)]||p[m]||u[m]||o;return r?a.createElement(f,i(i({ref:t},d),{},{components:r})):a.createElement(f,i({ref:t},d))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=p;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var l=2;l<o;l++)i[l]=r[l];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}p.displayName="MDXCreateElement"},2320:function(e,t,r){r.r(t),r.d(t,{assets:function(){return d},contentTitle:function(){return c},default:function(){return m},frontMatter:function(){return s},metadata:function(){return l},toc:function(){return u}});var a=r(3117),n=r(102),o=(r(7294),r(3905)),i=["components"],s={id:"partition-strategy",title:"Partition Strategy",description:"",tags:["adr"],number:"4","date-issued":"2021-05-19",status:"Accepted"},c=void 0,l={unversionedId:"architecture-decisions/records/partition-strategy",id:"architecture-decisions/records/partition-strategy",title:"Partition Strategy",description:"",source:"@site/docs/architecture-decisions/records/004-partition-strategy.md",sourceDirName:"architecture-decisions/records",slug:"/architecture-decisions/records/partition-strategy",permalink:"/Data-Platform-Playbook/architecture-decisions/records/partition-strategy",draft:!1,editUrl:"https://github.com/LBHackney-IT/data-platform-playbook/edit/master/docs/architecture-decisions/records/004-partition-strategy.md",tags:[{label:"adr",permalink:"/Data-Platform-Playbook/tags/adr"}],version:"current",sidebarPosition:4,frontMatter:{id:"partition-strategy",title:"Partition Strategy",description:"",tags:["adr"],number:"4","date-issued":"2021-05-19",status:"Accepted"},sidebar:"docs",previous:{title:"Role-Based Access Control",permalink:"/Data-Platform-Playbook/architecture-decisions/records/role-based-access-control"},next:{title:"Recovered Data",permalink:"/Data-Platform-Playbook/architecture-decisions/records/recovered-data"}},d={},u=[{value:"Context",id:"context",level:2},{value:"Decision",id:"decision",level:2},{value:"Consequences",id:"consequences",level:2}],p={toc:u};function m(e){var t=e.components,r=(0,n.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"context"},"Context"),(0,o.kt)("p",null,"When storing data into S3, access performance can be increased by partitioning datasets down into folder tree with the\nleaf folders containing subsets of the overall dataset. When products like AWS Athena access the overall dataset, it can\nlimit it's read processes to a selection of these leaf directories based on the data that needs to be queried."),(0,o.kt)("h2",{id:"decision"},"Decision"),(0,o.kt)("p",null,"Datasets on the platform will be stored in the following folder structure:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"{department/service}/{dataset-name}/import_year={import-year}/import_month={import-month}/import_day={import-day}/")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"department/service - The top level folder should always be the server/department that owns the data."),(0,o.kt)("li",{parentName:"ul"},"dateset-name - The name of the dataset, this is chosen by the user importing the data but should descriptive."),(0,o.kt)("li",{parentName:"ul"},"import-year/import-month/import-day - The year/month/day the dataset was written to the data platform, or in cases of ingesting\nthird-party data, the year/month/day the data was originally generated.")),(0,o.kt)("p",null,"Dataset that require additional partitioning for optimisation should be done so under this structure. E.g. A dataset that\nstores PCNs may choose to break the data down further by issue date:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"{department/service}/{dataset-name}/import_year={import-year}/import_month={import-month}/import_day={import-day}/issue_date={pcn-issue-date}")),(0,o.kt)("h2",{id:"consequences"},"Consequences"),(0,o.kt)("p",null,"This structure will allow us to store historic states of data, allowing analysis to reference back to previous versions\nof data to see how it was presented on that date.\nConversely, each ETL process will need to take into account that a dataset may have multiple days/months/years of data\nwith many duplicates is viewed collectively. Therefore, each query should filter down to the specifc day/month/year\nrequired unless viewing data historically."))}m.isMDXComponent=!0}}]);