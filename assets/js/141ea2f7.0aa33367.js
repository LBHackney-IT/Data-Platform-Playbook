"use strict";(self.webpackChunkdata_platform_playbook=self.webpackChunkdata_platform_playbook||[]).push([[5180],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>h});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),p=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},m=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),d=p(a),u=r,h=d["".concat(l,".").concat(u)]||d[u]||c[u]||o;return a?n.createElement(h,i(i({ref:t},m),{},{components:a})):n.createElement(h,i({ref:t},m))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:r,i[1]=s;for(var p=2;p<o;p++)i[p]=a[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},2966:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var n=a(7462),r=(a(7294),a(3905));const o={id:"access-my-service-data-history",title:"My service data history",description:"Onboarding data analysts and engineers to DAP\u21e8flow, the Data Analytics Platform Airflow integration.",layout:"playbook_js",tags:["onboarding"]},i="How will I access my service data history from Amazon Athena?",s={unversionedId:"dap-airflow/onboarding/access-my-service-data-history",id:"dap-airflow/onboarding/access-my-service-data-history",title:"My service data history",description:"Onboarding data analysts and engineers to DAP\u21e8flow, the Data Analytics Platform Airflow integration.",source:"@site/docs/dap-airflow/onboarding/access-my-service-data-history.md",sourceDirName:"dap-airflow/onboarding",slug:"/dap-airflow/onboarding/access-my-service-data-history",permalink:"/Data-Platform-Playbook/dap-airflow/onboarding/access-my-service-data-history",draft:!1,editUrl:"https://github.com/LBHackney-IT/data-platform-playbook/edit/master/docs/dap-airflow/onboarding/access-my-service-data-history.md",tags:[{label:"onboarding",permalink:"/Data-Platform-Playbook/tags/onboarding"}],version:"current",frontMatter:{id:"access-my-service-data-history",title:"My service data history",description:"Onboarding data analysts and engineers to DAP\u21e8flow, the Data Analytics Platform Airflow integration.",layout:"playbook_js",tags:["onboarding"]},sidebar:"docs",previous:{title:"My current service data",permalink:"/Data-Platform-Playbook/dap-airflow/onboarding/access-my-current-service-data"},next:{title:"Query my service data",permalink:"/Data-Platform-Playbook/dap-airflow/onboarding/query-my-service-data"}},l={},p=[{value:"1. Access Amazon Athena",id:"1-access-amazon-athena",level:3},{value:"2. Selecting and understanding your database",id:"2-selecting-and-understanding-your-database",level:3},{value:"3. Explore the tables in your database",id:"3-explore-the-tables-in-your-database",level:3},{value:"4. Expand each table",id:"4-expand-each-table",level:3},{value:"5. Verify the views and columns",id:"5-verify-the-views-and-columns",level:3},{value:"6. Observe the partition columns",id:"6-observe-the-partition-columns",level:3},{value:"<strong><em>&quot;We</em> \u2661 <em>your feedback!&quot;</em></strong>",id:"we--your-feedback",level:2},{value:"UX Criteria",id:"ux-criteria",level:4}],m={toc:p},d="wrapper";function c(e){let{components:t,...o}=e;return(0,r.kt)(d,(0,n.Z)({},m,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"how-will-i-access-my-service-data-history-from-amazon-athena"},"How will I access my service data history from Amazon Athena?"),(0,r.kt)("h3",{id:"1-access-amazon-athena"},"1. Access Amazon Athena"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"\ud83d\uddb1"))," In your web browser, log in to your AWS account, navigate to the AWS Management Console, and open Amazon Athena. "),(0,r.kt)("p",null,"\ud83d\udc49 First time Amazon Athena users should ",(0,r.kt)("strong",{parentName:"p"},"start here \u25ba")," ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"../onboarding/access-my-Amazon-Athena-database"},"DAP\u21e8flow\ud83d\udcdaAmazon Athena"))," "),(0,r.kt)("h3",{id:"2-selecting-and-understanding-your-database"},"2. Selecting and understanding your database"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"\ud83d\uddb1"))," Ensure that you have selected ",(0,r.kt)("inlineCode",{parentName:"p"},"[my service raw zone]"),' from the list box under the "',(0,r.kt)("strong",{parentName:"p"},"Database"),'" section on the left side of the Athena interface.'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"Fig. 2 & 3"))," ",(0,r.kt)("img",{alt:"Fig. 2 &amp; 3",src:a(3547).Z,width:"512",height:"251"})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Athena\u2019s databases are actually catalogs of the data stored in the AWS S3 storage buckets and folders, which we collectively call a ",(0,r.kt)("strong",{parentName:"p"},"data lake.")," From the top level, data lakes are divided by zone, then by service, then by service database. ")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"The service database folders are represented by ",(0,r.kt)("strong",{parentName:"p"},"databases")," in Athena which which are labeled in the reverse \u201c",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"service"),"-",(0,r.kt)("em",{parentName:"strong"},"database"),"-",(0,r.kt)("em",{parentName:"strong"},"zone\u201d format")),". The zone suffix labeling has the following meaning:  "),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u201c-",(0,r.kt)("strong",{parentName:"li"},"raw-zone"),'" for databases where data tables arrive after they are ingested from a service database and whose specification depends upon the source of that data.  '),(0,r.kt)("li",{parentName:"ul"},"\u201c-",(0,r.kt)("strong",{parentName:"li"},"refined-zone"),'" for databases where data goes whenever it is transformed and whose specification is implemented by data analysts and engineers when developing their data pipelines.  '),(0,r.kt)("li",{parentName:"ul"},"\u201c-",(0,r.kt)("strong",{parentName:"li"},"trusted-zone"),'" for databases containing the product tables whose specification is developed and agreed upon by data analysts and engineers in collaboration with their data users.')))),(0,r.kt)("p",null,"\ud83d\udc49 For more information on how Amazon S3 organizes data, go \u25ba",(0,r.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/organizing-objects.html"},(0,r.kt)("strong",{parentName:"a"},"here"))),(0,r.kt)("h3",{id:"3-explore-the-tables-in-your-database"},"3. Explore the tables in your database"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"\ud83d\uddb1")),' Beneath the "',(0,r.kt)("strong",{parentName:"p"},"Database"),'" section on the left of the Athena interface, expand the "',(0,r.kt)("strong",{parentName:"p"},"\u25ba Tables"),'" section to find the list of tables available from ',(0,r.kt)("inlineCode",{parentName:"p"},"[my service raw zone]")," database."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"This is how Athena presents tables from the S3 data lake. In S3\u2019s folder structure, tables are represented by folders below the service database folder.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"In this implementation, the table names were all suffixed with \u201c",(0,r.kt)("strong",{parentName:"p"},"_","history"),"\u201d to remind us that each table contains several daily generations of data traveling back in time.  "))),(0,r.kt)("h3",{id:"4-expand-each-table"},"4. Expand each table"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"\ud83d\uddb1"))," Click on each table name to expand it and observe the complete list of columns for that table."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"Fig. 4 & 5"))," ",(0,r.kt)("img",{alt:"Fig. 4 &amp; 5",src:a(956).Z,width:"512",height:"387"})),(0,r.kt)("h3",{id:"5-verify-the-views-and-columns"},"5. Verify the views and columns"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"\ud83d\udc41"))," Compare each table and its columns with the equivalent table and columns from ",(0,r.kt)("inlineCode",{parentName:"p"},"[my service database]")," to observe how their names and data types match up with their counterparts."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Occasionally the automatic data type translation will yield unexpected results. Always check columns to ensure there will never be any data lost. For example, if integer precision is lost.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Be specially aware of ",(0,r.kt)("strong",{parentName:"p"},"date")," translations. Dates are sometimes transmitted in specialized formats, possibly numerical or possibly textual. If we\u2019re unlucky these might need some coded reconciliation afterwards to make them both readable and useful in computations, especially used in comparison, or when joined to date columns from tables elsewhere."))),(0,r.kt)("h3",{id:"6-observe-the-partition-columns"},"6. Observe the partition columns"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"\ud83d\uddb1"))," Scroll to the bottom of the column list to find the partition scheme. This will comprise four or more partition columns shown with the partition data type alongside eg. ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"string (Partitioned)."))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"Fig. 6"))," ",(0,r.kt)("img",{alt:"Fig. 6",src:a(7594).Z,width:"512",height:"423"})),(0,r.kt)("p",null,"It helps to become familiar with the fundamental differences between a traditional database and a data lake that records the entire history of our data."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Because tables are ingested or otherwise transformed daily (the most common frequency), each table folder, in the S3 data lake, must be subdivided by it's ",(0,r.kt)("strong",{parentName:"p"},"generation"),", so the underlying technology of the data platform can quickly access either current data, or specified previous data, needed for transformations. ")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Generations are organized hierarchically using S3 folders represented by the following partition column strings:   "),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"Year"))," eg. \u201c",(0,r.kt)("strong",{parentName:"p"},"import","_","year"),"\u201d eg. \u20182024\u2019 (the current year)  ")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"Month"))," eg. \u201c",(0,r.kt)("strong",{parentName:"p"},"import","_","month"),"\u201d eg. \u201806\u2019 (the current month eg. June)  ")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"Day"))," eg. \u201c",(0,r.kt)("strong",{parentName:"p"},"import","_","day"),"\u201d eg. \u201805\u2019 (5th day of the current month)  ")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"Date"))," eg. \u201c",(0,r.kt)("strong",{parentName:"p"},"import","_","date"),"\u201d eg. \u201c20240605\u201d (5th June 2024",")","  "),(0,r.kt)("p",{parentName:"li"},'We might see alternatives to "',(0,r.kt)("strong",{parentName:"p"},"import","_"),'\u2026" column prefixes such as \u201c',(0,r.kt)("strong",{parentName:"p"},"transform","_"),"\u2026\u201d or \u201c",(0,r.kt)("strong",{parentName:"p"},"generation","_"),"\u2026\u201d, or observe combinations of generation the prefixes, to indicate data imported and transformed at different times.")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"We may observe other non-generational partition types, for example, we might want to subdivide the data after it is ingested in some other useful way, eg. by currency or historicity to facilitate data governance management and optimize our data pipelines even further. "))),(0,r.kt)("p",null,"\ud83d\udc49 So that Data Analysts are not overwhelmed by data partitioning, and can avoid using generational sub-queries in their transformations, a solution was developed which is ",(0,r.kt)("strong",{parentName:"p"},"documented here \u25ba")," ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"../onboarding/access-my-current-service-data"},"DAP\u21e8flow\ud83d\udcdaMy current service data"))," "),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"we--your-feedback"},(0,r.kt)("strong",{parentName:"h2"},(0,r.kt)("em",{parentName:"strong"},'"We')," \u2661 ",(0,r.kt)("em",{parentName:"strong"},'your feedback!"'))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"DAP\u21e8flow",src:a(2632).Z,width:"750",height:"100"}),"  "),(0,r.kt)("admonition",{title:"UX  ",type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"\ud83d\udc49 Please use ",(0,r.kt)("strong",{parentName:"p"},"this link \u25ba")," ",(0,r.kt)("a",{parentName:"p",href:"https://docs.google.com/forms/d/e/1FAIpQLSdqeNyWIPMNBHEr-YSyxnXQ4ggTwJPkffMYgFaJ4hGEhIL6LA/viewform?usp=pp_url&entry.339550210=access-my-service-data-history"},(0,r.kt)("strong",{parentName:"a"},"DAP\u21e8flow")," ",(0,r.kt)("inlineCode",{parentName:"a"},"UX")," ",(0,r.kt)("strong",{parentName:"a"},"Feedback / access-my-service-data-history")),"  "),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"Your feedback enables us to improve ",(0,r.kt)("strong",{parentName:"li"},"DAP\u21e8flow")," and our Data Analytics Platform service.  "),(0,r.kt)("li",{parentName:"ul"},"We encourage all our users to be generous with their time, in giving us their recollections and honest opinions about our service.  "),(0,r.kt)("li",{parentName:"ul"},"We especially encourage our new users to give feedback at the end of every ",(0,r.kt)("strong",{parentName:"li"},"\ud83d\udcdaOnboarding")," task because the quality of the onboarding experience really matters.",(0,r.kt)("br",{parentName:"li"}),"\u261d ",(0,r.kt)("strong",{parentName:"li"},"Please use this link to help us understand your user experience!"),"  "))),(0,r.kt)("h4",{id:"ux-criteria"},"UX Criteria"),(0,r.kt)("admonition",{title:"ABILITY  ",type:"info"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"Hackney ",(0,r.kt)("strong",{parentName:"li"},"AWS Management Console")," user  "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"[my service]")," Data Analyst"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"[my service database]")," user"))),(0,r.kt)("admonition",{title:"BEHAVIOR  ",type:"note"},(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("strong",{parentName:"p"},"Measures")," the behavior of ",(0,r.kt)("strong",{parentName:"p"},"Amazon Athena")," while the user explores ",(0,r.kt)("inlineCode",{parentName:"p"},"[my service raw zone]")," database tables and columns.  "),(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("strong",{parentName:"p"},"Given")," I have selected ",(0,r.kt)("inlineCode",{parentName:"p"},"[my service raw zone]")," database in the Amazon Athena interface",(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("strong",{parentName:"p"},"When")," I explore the list below \u201c",(0,r.kt)("strong",{parentName:"p"},"Tables"),"\u201d",(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("strong",{parentName:"p"},"~and")," expand each table name to list its columns",(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("strong",{parentName:"p"},"Then")," I should find table names equivalent to tables from ",(0,r.kt)("inlineCode",{parentName:"p"},"[my service database]")," with the suffix \u201c",(0,r.kt)("strong",{parentName:"p"},"_history"),"\u201d added",(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("strong",{parentName:"p"},"~and")," find equivalent column names with their respective equivalent data types",(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("strong",{parentName:"p"},"~and")," I should observe every table has partition columns added, eg. \u201cimport_date\u201d.  "),(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("strong",{parentName:"p"},"Scale")," of 3 ",(0,r.kt)("strong",{parentName:"p"},"~and")," flow features.  ")))}c.isMDXComponent=!0},2632:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/DAPairflowFLOWleft-e023069f4c3409ab8db1b918e04abb3b.png"},956:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/access-my-service-data-history-four-five-54b02eadf8e77a8df1ba9463c991b376.png"},7594:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/access-my-service-data-history-six-7755cb914faac5960eb80313c8fe02f3.png"},3547:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/access-my-service-data-history-two-three-b817b76ec865d79ec3af932c1a708eae.png"}}]);