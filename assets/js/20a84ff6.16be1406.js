"use strict";(self.webpackChunkdata_platform_playbook=self.webpackChunkdata_platform_playbook||[]).push([[6610],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>y});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var o=n.createContext({}),p=function(e){var t=n.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},d=function(e){var t=p(e.components);return n.createElement(o.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=p(a),c=r,y=u["".concat(o,".").concat(c)]||u[c]||m[c]||i;return a?n.createElement(y,s(s({ref:t},d),{},{components:a})):n.createElement(y,s({ref:t},d))}));function y(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,s=new Array(i);s[0]=c;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l[u]="string"==typeof e?e:r,s[1]=l;for(var p=2;p<i;p++)s[p]=a[p];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},5682:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>o,contentTitle:()=>s,default:()=>m,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var n=a(7462),r=(a(7294),a(3905));const i={title:"2. Basic Time Series helpers",description:"Generally useful Time Series Helpers",layout:"playbook_js",tags:["playbook"]},s="Basic Time Series helpers",l={unversionedId:"playbook/querying-and-analysing-data/time-series-analysis/basic_helpers",id:"playbook/querying-and-analysing-data/time-series-analysis/basic_helpers",title:"2. Basic Time Series helpers",description:"Generally useful Time Series Helpers",source:"@site/docs/playbook/querying-and-analysing-data/time-series-analysis/2-basic_helpers.md",sourceDirName:"playbook/querying-and-analysing-data/time-series-analysis",slug:"/playbook/querying-and-analysing-data/time-series-analysis/basic_helpers",permalink:"/Data-Platform-Playbook/playbook/querying-and-analysing-data/time-series-analysis/basic_helpers",draft:!1,editUrl:"https://github.com/LBHackney-IT/data-platform-playbook/edit/master/docs/playbook/querying-and-analysing-data/time-series-analysis/2-basic_helpers.md",tags:[{label:"playbook",permalink:"/Data-Platform-Playbook/tags/playbook"}],version:"current",sidebarPosition:2,frontMatter:{title:"2. Basic Time Series helpers",description:"Generally useful Time Series Helpers",layout:"playbook_js",tags:["playbook"]},sidebar:"docs",previous:{title:"1. Introduction to Time Series Helpers",permalink:"/Data-Platform-Playbook/playbook/querying-and-analysing-data/time-series-analysis/introduction"},next:{title:"3. Step by Step Guide to Forecasting",permalink:"/Data-Platform-Playbook/playbook/querying-and-analysing-data/time-series-analysis/step_by_step_example"}},o={},p=[{value:"Data Reshaping",id:"data-reshaping",level:3},{value:"Usage Example",id:"usage-example",level:3},{value:"Finding Start and End Date",id:"finding-start-and-end-date",level:3},{value:"Making Train Test subsets by count",id:"making-train-test-subsets-by-count",level:3},{value:"Why would we want to do this?",id:"why-would-we-want-to-do-this",level:3},{value:"Usage Example",id:"usage-example-1",level:3}],d={toc:p},u="wrapper";function m(e){let{components:t,...a}=e;return(0,r.kt)(u,(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"basic-time-series-helpers"},"Basic Time Series helpers"),(0,r.kt)("p",null,"These are the helpers which are going to be useful regardless of the model you want to use"),(0,r.kt)("h3",{id:"data-reshaping"},"Data Reshaping"),(0,r.kt)("p",null,"For simple Time Series forecasting, you generally want a dataframe or series with just the metric and  the date in the index, evenly spaced apart"),(0,r.kt)("p",null,"For example, The count of records (Metric) in each month (Date)"),(0,r.kt)("p",null,"We have a helper function which can help you transform your data into this format"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"from scripts.helpers.time_series_helpers import reshape_time_series_data\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"def reshape_time_series_data(\n  pdf: ps.DataFrame,\n  date_col: str,\n  var_cols: list,\n  dateformat: str\n)\n\nreturns ps.DataFrame\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"pdf: Your Dataframe"),(0,r.kt)("li",{parentName:"ul"},"date_col: The name of the date column, this will be converted into the index"),(0,r.kt)("li",{parentName:"ul"},"var_cols: The name of the metrics you want to use, in a list. A lot of the time you only want a single metric"),(0,r.kt)("li",{parentName:"ul"},"dateformat: Format of your date. For example YYYY/MM/DD would be %Y/%m%d")),(0,r.kt)("h3",{id:"usage-example"},"Usage Example"),(0,r.kt)("p",null,"Lets say you have a dataframe, with various metric columns but you wanted to just keep one of them, in particular the one called total_call_time"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'reshaped_df = reshape_time_series_data(pdf,"date",["total_call_time"], "%Y/%M/%d")\n\n')),(0,r.kt)("h3",{id:"finding-start-and-end-date"},"Finding Start and End Date"),(0,r.kt)("p",null,"Some forecast functions will need a start and end date. If you need to quickly find these out from your data and the amount of prediction points, we have a function for that"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"from scripts.helpers.time_series_helpers import reshape_time_series_data\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"def get_start_end_date(\n  dataframe: pd.DataFrame,\n  period: str,\n  forecast_count: int\n)\n\nreturns start_date date,end_date date\n")),(0,r.kt)("p",null,"So an example of calling this would be"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'start_date, end_date = get_start_end_date(df,"M",12)\n')),(0,r.kt)("p",null,'If the final date in the index of DF is "01/12/2022"'),(0,r.kt)("p",null,'start_date = "01/01/2023"'),(0,r.kt)("p",null,'end_date = "01/12/2023"'),(0,r.kt)("h3",{id:"making-train-test-subsets-by-count"},"Making Train Test subsets by count"),(0,r.kt)("p",null,"When evaluating models, we use something called Train Test as a testing methodology"),(0,r.kt)("h3",{id:"why-would-we-want-to-do-this"},"Why would we want to do this?"),(0,r.kt)("p",null,"This function will split your data into 2 parts for this purpose"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"from scripts.helpers.time_series_helpers import get_train_test_subsets\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"def get_train_test_subsets(\n  time_series: ps.DataFrame,\n  periods: int):\n\nReturns:\n  Train(DataFrame),Test(DataFrame)\n\n")),(0,r.kt)("h3",{id:"usage-example-1"},"Usage Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"train, test = get_train_test_subsets(pdf,6)\n")),(0,r.kt)("p",null,"If pdf is of length 10, train will be of length 4 and test will be of length 6\nIf pdf is of length 100, train will be of length 94 and test will be of length 6"))}m.isMDXComponent=!0}}]);