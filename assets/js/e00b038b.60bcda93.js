"use strict";(self.webpackChunkdata_platform_playbook=self.webpackChunkdata_platform_playbook||[]).push([[1323],{4011:(e,i,o)=>{o.r(i),o.d(i,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});var t=o(4848),n=o(8453);const l={title:"Import files from google to s3",description:"Import files from google to s3 description",layout:"playbook_js",tags:["playbook"]},r=void 0,s={id:"archived-articles/import-files-from-google-to-S3",title:"Import files from google to s3",description:"Import files from google to s3 description",source:"@site/docs/archived-articles/import-files-from-google-to-S3.md",sourceDirName:"archived-articles",slug:"/archived-articles/import-files-from-google-to-S3",permalink:"/Data-Platform-Playbook/archived-articles/import-files-from-google-to-S3",draft:!1,unlisted:!1,editUrl:"https://github.com/LBHackney-IT/data-platform-playbook/edit/master/docs/archived-articles/import-files-from-google-to-S3.md",tags:[{inline:!0,label:"playbook",permalink:"/Data-Platform-Playbook/tags/playbook"}],version:"current",frontMatter:{title:"Import files from google to s3",description:"Import files from google to s3 description",layout:"playbook_js",tags:["playbook"]}},a={},d=[{value:"Preparing to import the file from Google drive",id:"preparing-to-import-the-file-from-google-drive",level:2},{value:"Getting file detail",id:"getting-file-detail",level:2},{value:"Setting up the copier lambda",id:"setting-up-the-copier-lambda",level:2}];function c(e){const i={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",ul:"ul",...(0,n.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.h2,{id:"preparing-to-import-the-file-from-google-drive",children:"Preparing to import the file from Google drive"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Open the file you would like to import"}),"\n",(0,t.jsx)(i.li,{children:"Ensure that all columns have headers. Columns without headers will be lost"}),"\n",(0,t.jsxs)(i.li,{children:["Click ",(0,t.jsx)(i.code,{children:"Share"})," in the top right corner of the sheet"]}),"\n",(0,t.jsx)(i.li,{children:"If the document is unnamed, name it"}),"\n",(0,t.jsx)(i.li,{children:"Paste in the service account email address you have been provided into the email box"}),"\n",(0,t.jsx)(i.li,{children:"Ensure the suggested email matches the service account email and select it"}),"\n",(0,t.jsxs)(i.li,{children:["On the new window, choose from the dropdown on the right hand side and select ",(0,t.jsx)(i.code,{children:"Viewer"})]}),"\n",(0,t.jsxs)(i.li,{children:["Uncheck the ",(0,t.jsx)(i.code,{children:"Notify people"})," checkbox"]}),"\n",(0,t.jsxs)(i.li,{children:["Click ",(0,t.jsx)(i.code,{children:"Share"})]}),"\n",(0,t.jsxs)(i.li,{children:["You will be asked to confirm sharing outside the organisation, click ",(0,t.jsx)(i.code,{children:"share anyway"})]}),"\n",(0,t.jsx)(i.li,{children:"Your file is now available for import"}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"getting-file-detail",children:"Getting file detail"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"You will need to obtain the document key from the url"}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:["The document id is the portion of the url between ",(0,t.jsx)(i.code,{children:"https://docs.google.com/file/d/"})," and ",(0,t.jsx)(i.code,{children:"/edit#gid=0"}),". See example below"]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"file id",src:o(4193).A+"",width:"1336",height:"60"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"setting-up-the-copier-lambda",children:"Setting up the copier lambda"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Before setting up an AWS Glue job, ensure that the relevant department configuration for that account is set up in AWS"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["see ",(0,t.jsx)(i.code,{children:"Adding a department"})," section in ",(0,t.jsx)(i.code,{children:"managing-departments.md"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:["Open the ",(0,t.jsx)(i.a,{href:"https://github.com/LBHackney-IT/data-platform",children:"Data Platform Project"}),". You'll need to have a Github account (which you can create yourself using your Hackney email) and have been added to the 'LBHackney-IT' team to view this project (you'll need to request this from Rashmi Shetty). If you don't have the correct permissions, you'll get a '404' error."]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:["Navigate to the main ",(0,t.jsx)(i.code,{children:"terraform"})," directory (data-platform/terraform)"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:["Open the ",(0,t.jsx)(i.code,{children:"65-g-drive-to-s3"})," terraform file"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Switch to 'edit mode' (using edit button on top right)"}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Copy one of the modules above, paste at the bottom of the file and update the following fields:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"module"}),' = "your-unique-module-name" (it is helpful to keep the same naming convention as your dataset/folder)']}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"lambda_name"}),' = "Your lambda name" (this is what you\'ll see in the Glue console, can be the same as your module name)']}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"file_id"}),' = "Your document id - see the ',(0,t.jsx)(i.code,{children:"Getting file detail"}),' section above"']}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"file_name"}),' = "The name of the file you are importing including the file extension and using underscores instead of spaces"']}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"service_area"}),' = "The name of the service area folder you would like to store in e.g. ',(0,t.jsx)(i.code,{children:"housing"}),", ",(0,t.jsx)(i.code,{children:"social-care"}),"\" (if this folder doesn't already exist in S3 you can name it here and this script will create it)"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Committing your changes: The Data Platform team needs to approve any changes to the code, so your change won't happen automatically. To submit your change:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Provide a description to explain what you've changed"}),"\n",(0,t.jsxs)(i.li,{children:["Select the option to create a ",(0,t.jsx)(i.code,{children:"new branch"})," for this commit (i.e. the code you've changed). You can just use the suggested name for your branch."]}),"\n",(0,t.jsx)(i.li,{children:"Once you click 'Propose changes' you'll have the opportunity to add even more detail if needed before submitted for review."}),"\n",(0,t.jsx)(i.li,{children:"You'll receive an email to confirm that your changes have been approved."}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,n.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},4193:(e,i,o)=>{o.d(i,{A:()=>t});const t=o.p+"assets/images/google_spreadsheet_id_example-b0d0193617957f913c71663d81819975.png"},8453:(e,i,o)=>{o.d(i,{R:()=>r,x:()=>s});var t=o(6540);const n={},l=t.createContext(n);function r(e){const i=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function s(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),t.createElement(l.Provider,{value:i},e.children)}}}]);