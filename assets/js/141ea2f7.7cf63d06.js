"use strict";(self.webpackChunkdata_platform_playbook=self.webpackChunkdata_platform_playbook||[]).push([[4362],{5717:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>t,metadata:()=>o,toc:()=>l});var a=n(4848),r=n(8453);const t={id:"access-my-service-data-history",title:"My service data history",description:"Onboarding data analysts and engineers to DAP\u21e8flow, the Data Analytics Platform Airflow integration.",layout:"playbook_js",tags:["onboarding"]},i="How will I access my [service]'s data history from Amazon Athena?",o={id:"dap-airflow/onboarding/access-my-service-data-history",title:"My service data history",description:"Onboarding data analysts and engineers to DAP\u21e8flow, the Data Analytics Platform Airflow integration.",source:"@site/docs/dap-airflow/onboarding/access-my-service-data-history.md",sourceDirName:"dap-airflow/onboarding",slug:"/dap-airflow/onboarding/access-my-service-data-history",permalink:"/Data-Platform-Playbook/dap-airflow/onboarding/access-my-service-data-history",draft:!1,unlisted:!1,editUrl:"https://github.com/LBHackney-IT/data-platform-playbook/edit/master/docs/dap-airflow/onboarding/access-my-service-data-history.md",tags:[{inline:!0,label:"onboarding",permalink:"/Data-Platform-Playbook/tags/onboarding"}],version:"current",frontMatter:{id:"access-my-service-data-history",title:"My service data history",description:"Onboarding data analysts and engineers to DAP\u21e8flow, the Data Analytics Platform Airflow integration.",layout:"playbook_js",tags:["onboarding"]},sidebar:"docs",previous:{title:"My current service data",permalink:"/Data-Platform-Playbook/dap-airflow/onboarding/access-my-current-service-data"},next:{title:"Query my service data",permalink:"/Data-Platform-Playbook/dap-airflow/onboarding/query-my-service-data"}},d={},l=[{value:"1. Access <em><strong>Amazon Athena</strong></em>",id:"1-access-amazon-athena",level:2},{value:"2. Understanding your <code>[service raw zone]</code> database",id:"2-understanding-your-service-raw-zone-database",level:2},{value:"3. Explore the tables in your database",id:"3-explore-the-tables-in-your-database",level:2},{value:"4. Expanding each table",id:"4-expanding-each-table",level:2},{value:"5. Verifying the views and columns",id:"5-verifying-the-views-and-columns",level:2},{value:"6. Observing the partition columns",id:"6-observing-the-partition-columns",level:2},{value:"\ud83d\udca1 Traditional databases versus a data lake",id:"-traditional-databases-versus-a-data-lake",level:4},{value:"<strong><em>&quot;We</em> \u2661 <em>your feedback!&quot;</em></strong>",id:"we--your-feedback",level:2},{value:"\ud83d\udc49 Please use <strong>this link \u25ba</strong> <strong>DAP\u21e8flow</strong> <code>UX</code> <strong>Feedback / access-my-service-data-history</strong>",id:"-please-use-this-link--dapflow-ux-feedback--access-my-service-data-history",level:3},{value:"\ud83d\udcda<code>UX</code> Criteria",id:"ux-criteria",level:2},{value:"How will I access my <code>[service]</code>&#39;s data history from <em><strong>Amazon Athena</strong></em>?",id:"how-will-i-access-my-services-data-history-from-amazon-athena-1",level:3}];function c(e){const s={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsxs)(s.h1,{id:"how-will-i-access-my-services-data-history-from-amazon-athena",children:["How will I access my ",(0,a.jsx)(s.code,{children:"[service]"}),"'s data history from ",(0,a.jsx)(s.em,{children:(0,a.jsx)(s.strong,{children:"Amazon Athena"})}),"?"]})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"DAP\u21e8flow",src:n(2854).A+"",width:"750",height:"100"})}),"\n",(0,a.jsxs)(s.h2,{id:"1-access-amazon-athena",children:["1. Access ",(0,a.jsx)(s.em,{children:(0,a.jsx)(s.strong,{children:"Amazon Athena"})})]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"\ud83d\uddb1"})})," In your web browser, log in to your AWS account, navigate to the ",(0,a.jsx)(s.em,{children:(0,a.jsx)(s.strong,{children:"AWS Management Console"})}),", and open ",(0,a.jsx)(s.em,{children:(0,a.jsx)(s.strong,{children:"Amazon Athena"})}),"."]}),"\n",(0,a.jsxs)(s.p,{children:["\ud83d\udc49 First time ",(0,a.jsx)(s.em,{children:(0,a.jsx)(s.strong,{children:"Amazon Athena"})})," users should ",(0,a.jsx)(s.strong,{children:"start here \u25ba"})," ",(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.a,{href:"../onboarding/access-my-Amazon-Athena-database",children:"DAP\u21e8flow\ud83d\udcdaAmazon Athena"})})]}),"\n",(0,a.jsxs)(s.h2,{id:"2-understanding-your-service-raw-zone-database",children:["2. Understanding your ",(0,a.jsx)(s.code,{children:"[service raw zone]"})," database"]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"\ud83d\uddb1"})})," Ensure you have selected your ",(0,a.jsx)(s.code,{children:"[service raw zone]"}),' from the list box under the "',(0,a.jsx)(s.strong,{children:"Database"}),'" section on the left side of the Athena interface.']}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"Fig. 2 & 3"})})," ",(0,a.jsx)(s.img,{alt:"Fig. 2 &amp; 3",src:n(7145).A+"",width:"512",height:"251"})]}),"\n",(0,a.jsx)(s.admonition,{title:"REMINDER",type:"info",children:(0,a.jsxs)(s.p,{children:["\ud83d\udc49  Your ",(0,a.jsxs)(s.strong,{children:["Service Terms",(0,a.jsx)(s.code,{children:"[]"})]})," are defined in the ",(0,a.jsx)(s.em,{children:(0,a.jsx)(s.strong,{children:"welcome"})})," document stored in your ",(0,a.jsxs)(s.a,{href:"https://drive.google.com/drive/folders/1k30M7Hh8WLttL5T5JVGbnKvSLNX7lVSg?usp=drive_link",children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"[service access group]"})})," ",(0,a.jsx)(s.em,{children:(0,a.jsx)(s.strong,{children:"Google Drive subfolder"})})]}),"."]})}),"\n",(0,a.jsxs)(s.p,{children:["\ud83d\udca1 Athena\u2019s databases are actually catalogs of the data stored in the ",(0,a.jsx)(s.em,{children:(0,a.jsx)(s.strong,{children:"AWS S3"})})," storage buckets and folders, which we collectively call a ",(0,a.jsx)(s.strong,{children:"data lake."})," From the top level, data lakes are divided by zone, then by service, then by service database."]}),"\n",(0,a.jsxs)(s.p,{children:["\ud83d\udca1 The service database folders are represented by ",(0,a.jsx)(s.strong,{children:"databases"})," in Athena that are labeled in the reverse ",(0,a.jsx)(s.em,{children:(0,a.jsx)(s.code,{children:"service-database-zone"})})," format. The ",(0,a.jsx)(s.em,{children:"zone suffix"})," labeling has the following meaning:"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"...-raw-zone"})})," for databases where data tables arrive after they are ingested from a service database and whose specification depends upon the source of that data."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"...-refined-zone"})})," for databases where data goes whenever it is transformed and whose specification is implemented by data analysts and engineers when developing their data pipelines."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"...-trusted-zone"})})," for databases containing the product tables whose specification is developed and agreed upon by data analysts and engineers in collaboration with their data users."]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["\ud83d\udc49 For more information on how Amazon S3 organizes data, see \u25ba",(0,a.jsx)(s.a,{href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/organizing-objects.html",children:(0,a.jsx)(s.strong,{children:"here"})})]}),"\n",(0,a.jsx)(s.h2,{id:"3-explore-the-tables-in-your-database",children:"3. Explore the tables in your database"}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"\ud83d\uddb1"})}),' Beneath the "',(0,a.jsx)(s.strong,{children:"Database"}),'" section on the left of the Athena interface, expand the "',(0,a.jsxs)(s.strong,{children:[(0,a.jsx)(s.code,{children:"\u25ba"})," Tables"]}),'" section to find the list of tables available from your ',(0,a.jsx)(s.code,{children:"[service raw zone]"})," database."]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsx)(s.p,{children:"This is how Athena presents tables from the S3 data lake. In S3\u2019s folder structure, tables are represented by folders below the service database folder."}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsxs)(s.p,{children:["In this implementation, the table names were all suffixed ",(0,a.jsx)(s.code,{children:"..._history"})," to remind us that each table contains several daily generations of data stretching back in time."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"4-expanding-each-table",children:"4. Expanding each table"}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"\ud83d\uddb1"})})," Click on each table name to expand it and observe the complete list of columns for that table."]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"Fig. 4 & 5"})})," ",(0,a.jsx)(s.img,{alt:"Fig. 4 &amp; 5",src:n(3429).A+"",width:"512",height:"387"})]}),"\n",(0,a.jsx)(s.h2,{id:"5-verifying-the-views-and-columns",children:"5. Verifying the views and columns"}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"\ud83d\udc41"})})," Compare each table and its columns with the equivalent table and columns from your ",(0,a.jsx)(s.code,{children:"[service database]"})," to observe how their names and data types match up with their counterparts."]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsx)(s.p,{children:"Occasionally the automatic data type translation will yield unexpected results. Always check columns to ensure there will never be any data lost. For example, if integer precision is lost."}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsxs)(s.p,{children:["Be especially aware of ",(0,a.jsx)(s.em,{children:"date"})," translations. Dates are sometimes transmitted in specialized formats, possibly numerical or possibly textual. If we\u2019re unlucky these might need some coded reconciliation afterwards to make them both readable and useful in computations, especially when used in comparison, or used to join ",(0,a.jsx)(s.em,{children:"date"})," columns from tables elsewhere."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"6-observing-the-partition-columns",children:"6. Observing the partition columns"}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"\ud83d\uddb1"})})," Scroll to the bottom of the column list to find the partition scheme. This will comprise three, or four, or more partition columns shown with the partition data type alongside eg. ",(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"string (Partitioned)"})}),"."]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"Fig. 6"})})," ",(0,a.jsx)(s.img,{alt:"Fig. 6",src:n(5028).A+"",width:"512",height:"423"})]}),"\n",(0,a.jsx)(s.h4,{id:"-traditional-databases-versus-a-data-lake",children:"\ud83d\udca1 Traditional databases versus a data lake"}),"\n",(0,a.jsx)(s.p,{children:"It helps to become familiar with the fundamental differences between a traditional database and a data lake that records the entire history of our data."}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsxs)(s.p,{children:["Because tables are ingested or otherwise transformed daily (the most common frequency), each table folder, in the S3 data lake, must be subdivided by it's ",(0,a.jsx)(s.strong,{children:"generation"}),", so the underlying technology of the data platform can quickly access either current data, or specified previous data, needed for transformations."]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsx)(s.p,{children:"Generations are organized hierarchically using S3 folders represented by the following partition column strings:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.em,{children:(0,a.jsx)(s.strong,{children:"Year"})})," eg. ",(0,a.jsx)(s.code,{children:"import_year"})," eg. \u20182024\u2019 (the current year)"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.em,{children:(0,a.jsx)(s.strong,{children:"Month"})})," eg. ",(0,a.jsx)(s.code,{children:"import_month"})," eg. \u201806\u2019 (the current month eg. June)"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.em,{children:(0,a.jsx)(s.strong,{children:"Day"})})," eg. ",(0,a.jsx)(s.code,{children:"import_day"})," eg. \u201805\u2019 (5th day of the current month)"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.em,{children:(0,a.jsx)(s.strong,{children:"Date"})})," eg. ",(0,a.jsx)(s.code,{children:"import_date"})," eg. \u201c20240605\u201d (5th June 2024)"]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["We might see alternatives to ",(0,a.jsx)(s.code,{children:"import_\u2026"})," column prefixes such as ",(0,a.jsx)(s.code,{children:"transform_\u2026"})," or ",(0,a.jsx)(s.code,{children:"generation_\u2026"}),", or observe combinations of generation the prefixes, to indicate data imported and transformed at different times."]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsxs)(s.p,{children:["We may observe other non-generational partition types, for example, we might want to subdivide the data after it is ingested in some other useful way, eg. by ",(0,a.jsx)(s.em,{children:"currency"})," or ",(0,a.jsx)(s.em,{children:"historicity"})," to facilitate data governance management or optimize our data pipelines in some way."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["\ud83d\udc49 So that Data Analysts are not overwhelmed by the data partitioning scheme, and can avoid using complex generational sub-queries in their transformations, a better solution was developed. The product of that development is ",(0,a.jsx)(s.strong,{children:"documented here \u25ba"})," ",(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.a,{href:"../onboarding/access-my-current-service-data",children:"DAP\u21e8flow\ud83d\udcdaMy current service data"})})]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"we--your-feedback",children:(0,a.jsxs)(s.strong,{children:[(0,a.jsx)(s.em,{children:'"We'})," \u2661 ",(0,a.jsx)(s.em,{children:'your feedback!"'})]})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"DAP\u21e8flow",src:n(2854).A+"",width:"750",height:"100"})}),"\n",(0,a.jsxs)(s.admonition,{title:"UX",type:"tip",children:[(0,a.jsxs)(s.h3,{id:"-please-use-this-link--dapflow-ux-feedback--access-my-service-data-history",children:["\ud83d\udc49 Please use ",(0,a.jsx)(s.strong,{children:"this link \u25ba"})," ",(0,a.jsxs)(s.a,{href:"https://docs.google.com/forms/d/e/1FAIpQLSdqeNyWIPMNBHEr-YSyxnXQ4ggTwJPkffMYgFaJ4hGEhIL6LA/viewform?usp=pp_url&entry.339550210=access-my-service-data-history",children:[(0,a.jsx)(s.strong,{children:"DAP\u21e8flow"})," ",(0,a.jsx)(s.code,{children:"UX"})," ",(0,a.jsx)(s.strong,{children:"Feedback / access-my-service-data-history"})]})]}),(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsxs)(s.p,{children:["Your feedback enables us to improve ",(0,a.jsx)(s.strong,{children:"DAP\u21e8flow"})," and our Data Analytics Platform service."]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsx)(s.p,{children:"We encourage all our users to be generous with their time, in giving us their recollections and honest opinions about our service."}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsxs)(s.p,{children:["We especially encourage our new users to give feedback at the end of every ",(0,a.jsx)(s.strong,{children:"\ud83d\udcdaOnboarding"})," task because the quality of the onboarding experience really matters."]}),"\n",(0,a.jsxs)(s.p,{children:["\u261d ",(0,a.jsx)(s.strong,{children:"Please use this link to help us understand your user experience!"})]}),"\n"]}),"\n"]})]}),"\n",(0,a.jsxs)(s.h2,{id:"ux-criteria",children:["\ud83d\udcda",(0,a.jsx)(s.code,{children:"UX"})," Criteria"]}),"\n",(0,a.jsx)(s.admonition,{title:"ABILITY",type:"info",children:(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"AWS Management Console"})," user"]}),"\n",(0,a.jsxs)(s.li,{children:["Hackney ",(0,a.jsx)(s.code,{children:"[service]"})," Data Analyst"]}),"\n",(0,a.jsxs)(s.li,{children:["Hackney ",(0,a.jsx)(s.code,{children:"[service database]"})," user"]}),"\n"]})}),"\n",(0,a.jsxs)(s.admonition,{title:"BEHAVIOR",type:"note",children:[(0,a.jsxs)(s.h3,{id:"how-will-i-access-my-services-data-history-from-amazon-athena-1",children:["How will I access my ",(0,a.jsx)(s.code,{children:"[service]"}),"'s data history from ",(0,a.jsx)(s.em,{children:(0,a.jsx)(s.strong,{children:"Amazon Athena"})}),"?"]}),(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Measures"})," the behavior of ",(0,a.jsx)(s.strong,{children:"Amazon Athena"})," while users explore their ",(0,a.jsx)(s.code,{children:"[service raw zone]"})," database tables and columns:"]}),(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Given"})," I selected my ",(0,a.jsx)(s.code,{children:"[service raw zone]"})," database in the ",(0,a.jsx)(s.em,{children:(0,a.jsx)(s.strong,{children:"Amazon Athena"})})," interface"]}),(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"When"})," I explore the list below \u201c",(0,a.jsx)(s.strong,{children:"Tables"}),"\u201d",(0,a.jsx)(s.br,{}),"\n",(0,a.jsx)(s.strong,{children:"~and"})," expand each table name to list its columns"]}),(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Then"})," I should find table names equivalent to tables from my ",(0,a.jsx)(s.code,{children:"[service database]"})," with the suffix ",(0,a.jsx)(s.code,{children:"..._history"})," added",(0,a.jsx)(s.br,{}),"\n",(0,a.jsx)(s.strong,{children:"~and"})," find equivalent column names with their respective equivalent data types",(0,a.jsx)(s.br,{}),"\n",(0,a.jsx)(s.strong,{children:"~and"})," I should observe every table has partition columns added, eg. ",(0,a.jsx)(s.code,{children:"import_date"}),"."]}),(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Scale"})," of 3 ",(0,a.jsx)(s.strong,{children:"~and"})," flow features."]})]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},2854:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/images/DAPairflowFLOWleft-e023069f4c3409ab8db1b918e04abb3b.png"},3429:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/images/access-my-service-data-history-four-five-54b02eadf8e77a8df1ba9463c991b376.png"},5028:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/images/access-my-service-data-history-six-7755cb914faac5960eb80313c8fe02f3.png"},7145:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/images/access-my-service-data-history-two-three-b817b76ec865d79ec3af932c1a708eae.png"},8453:(e,s,n)=>{n.d(s,{R:()=>i,x:()=>o});var a=n(6540);const r={},t=a.createContext(r);function i(e){const s=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),a.createElement(t.Provider,{value:s},e.children)}}}]);