<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="search" type="application/opensearchdescription+xml" title="Hackney Data Platform Playbook" href="/Data-Platform-Playbook/opensearch.xml"><title data-react-helmet="true">Datahub deployment | Hackney Data Platform Playbook</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://playbook.hackney.gov.uk//Data-Platform-Playbook/spikes/datahub-deployment"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Datahub deployment | Hackney Data Platform Playbook"><meta data-react-helmet="true" name="description" content="Review datahub as a potential solution for a data catalogue"><meta data-react-helmet="true" property="og:description" content="Review datahub as a potential solution for a data catalogue"><link data-react-helmet="true" rel="shortcut icon" href="/Data-Platform-Playbook/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://playbook.hackney.gov.uk//Data-Platform-Playbook/spikes/datahub-deployment"><link data-react-helmet="true" rel="alternate" href="https://playbook.hackney.gov.uk//Data-Platform-Playbook/spikes/datahub-deployment" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://playbook.hackney.gov.uk//Data-Platform-Playbook/spikes/datahub-deployment" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/Data-Platform-Playbook/assets/css/styles.1180568a.css">
<link rel="preload" href="/Data-Platform-Playbook/assets/js/runtime~main.ccb51e9d.js" as="script">
<link rel="preload" href="/Data-Platform-Playbook/assets/js/main.ef2f8cd2.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Data-Platform-Playbook/"><img src="/Data-Platform-Playbook/img/logo-long.svg" alt="Data Platform Playbook" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/Data-Platform-Playbook/img/logo-long.svg" alt="Data Platform Playbook" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Data Platform Playbook</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/LBHackney-IT/data-platform-playbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">About</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Playbook</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Technical Documentation</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Architecture Decision</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Spikes</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/spikes/amundsen-deployment">Amundsen deployment</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/spikes/data-quality-testing">Data Quality Testing</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Data-Platform-Playbook/spikes/datahub-deployment">Datahub deployment</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/spikes/mssql-ingestion">Ingesting data from MSSQL database</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/spikes/qlik-integration">Qlik Integration</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/spikes/sagemaker">Sagemaker</a></li></ul></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/Data-Platform-Playbook/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/Data-Platform-Playbook/roles">Roles</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Datahub deployment</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="objective"></a>Objective<a class="hash-link" href="#objective" title="Direct link to heading">#</a></h2><p>Confirm that the data catalog meets the minimum expectations for infrastructure and security so that it can be maintained long term</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="considerations"></a>Considerations<a class="hash-link" href="#considerations" title="Direct link to heading">#</a></h2><p>The following criteria were to be investigated</p><ul><li>Docker/container setup (via compose, ECS, Fargate etc)</li><li>SSO</li><li>Role Based Access Control</li><li>Notifications/Alerts</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="findings"></a>Findings<a class="hash-link" href="#findings" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="dockercontainer-setup-via-compose-ecs-fargate-etc"></a>Docker/container setup (via compose, ECS, Fargate etc)<a class="hash-link" href="#dockercontainer-setup-via-compose-ecs-fargate-etc" title="Direct link to heading">#</a></h3><p>Deploying this with docker and ECS was not feasible due to the number of dependencies.</p><p>Datahub provides <a href="https://datahubproject.io/docs/deploy/aws" target="_blank" rel="noopener noreferrer">documentation</a> on how to deploy using Kubernetes and AWS EKS. Due to a lack of kubernetes expertise, this route was not further explored.</p><p>Finally, we got deployed datahub by <a href="https://gist.github.com/elena-vi/032b3f4aba12a8e1d0ed8e7cb05fd66e" target="_blank" rel="noopener noreferrer">provisioning an ec2 instance</a>, connecting to the instace though SSH, cloning the <a href="https://github.com/linkedin/datahub" target="_blank" rel="noopener noreferrer">datahub repository</a> in the instance, and running datahub via <code>docker-compose</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="sso"></a>SSO<a class="hash-link" href="#sso" title="Direct link to heading">#</a></h3><p>You can <a href="https://datahubproject.io/docs/how/auth/sso/configure-oidc-react/" target="_blank" rel="noopener noreferrer">enable OIDC SSO</a> in React application (datahub frontend).</p><p>This was not investigated in this spike due to lack of time.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="role-based-access-control"></a>Role Based Access Control<a class="hash-link" href="#role-based-access-control" title="Direct link to heading">#</a></h3><p><em>Limitation:</em> Not reviewed as part of the spike, ran out of time.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="summary"></a>Summary<a class="hash-link" href="#summary" title="Direct link to heading">#</a></h2><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="limitations"></a>Limitations<a class="hash-link" href="#limitations" title="Direct link to heading">#</a></h4><ul><li>Could not get DataHub CLI with the deployment process specified above to work</li><li>Must ensure a process for constantly re-cloning the repo for updates</li><li>Datahub has various dependencies</li><li>There are no obvious solutions for notifications or alerts</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="suggestions"></a>Suggestions<a class="hash-link" href="#suggestions" title="Direct link to heading">#</a></h4><ul><li>Investigate datahub SAAS as an option</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="helpful-resources--documentation"></a>Helpful Resources / Documentation<a class="hash-link" href="#helpful-resources--documentation" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="deploying-to-ec2"></a>Deploying to EC2<a class="hash-link" href="#deploying-to-ec2" title="Direct link to heading">#</a></h3><ul><li>To deploy datahub, ensure an EC2 instance with at least 4GM memory to be able to run datahub docker</li><li>SSH into the instance and run the following:</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><pre tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo yum update -y</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo amazon-linux-extras install docker</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo service docker start</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo usermod -a -G docker ec2-user</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># restart connection</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo yum install git -y</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  # install docer-compose</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo curl -L https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m) -o /usr/local/bin/docker-compose</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo chmod +x /usr/local/bin/docker-compose</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  # download datahub</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">git clone https://github.com/linkedin/datahub.git</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cd datahub/docker/quickstart</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  # start datahub</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker-compose -f docker-compose.quickstart.yml up -d</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cd ../../metadata-ingestion/examples/recipes/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vi glue_to_datahub.yml # add params</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">python3 -m pip install --upgrade pip wheel setuptools</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pip install &#x27;acryl-datahub[glue]&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub ingest -c glue_to_datahub.yml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="deploying-to-eks"></a>Deploying to EKS<a class="hash-link" href="#deploying-to-eks" title="Direct link to heading">#</a></h3><ul><li>To deploy datahub to EKS we used eksctl, helm and kubectl using the following <a href="https://datahubproject.io/docs/deploy/aws" target="_blank" rel="noopener noreferrer">guide</a></li><li>When deploying to a production environment we would prefer to deploy using terraform.</li></ul><p>We have added helper files to the data platform project under the <code>datahub-deployment</code> directory. This directory includes:</p><ul><li>A <a href="https://github.com/LBHackney-IT/Data-Platform/blob/datahub-eks-deployment/datahub-deployment/Makefile" target="_blank" rel="noopener noreferrer">makefile</a> with commands for various common tasks</li><li>A values.yaml file which contains a helm config for the datahub chart</li><li>A kubeconfig file with the details for connecting to staging eks cluster<ul><li>Note: The file does NOT contain credentials, your aws credentials are used</li></ul></li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor anchor__h5 anchorWithStickyNavbar_31ik" id="makefile"></a>Makefile<a class="hash-link" href="#makefile" title="Direct link to heading">#</a></h5><p>The make file contains the following commands:</p><p><code>generate-kubeconfig-file</code>
Creates or updates the kubeconfig file for the staging cluster</p><p><code>get-all</code>
Get information about all the resources running in the cluster</p><p><code>upgrade-datahub-release</code>
Updates the datahub images to the latest version</p><p><code>datahub-release-history</code>
Prints historical revisions for a given release</p><p><code>pull-datahub-repository</code>
Pull the latest datahub helm repository</p><p><code>datahub-source</code>
Git clone the datahub project repo to your current location</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="data-ingestion"></a>Data Ingestion<a class="hash-link" href="#data-ingestion" title="Direct link to heading">#</a></h4><p>To ingest data into the data catalogue we followed this guide: <a href="https://datahubproject.io/docs/metadata-ingestion" target="_blank" rel="noopener noreferrer">Metadata Ingestion</a></p><p>This involved installing the PyPI prerequisites on a engineer machine using the following commands:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><pre tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">python3 -m venv venv</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source venv/bin/activate</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pip3 install --upgrade pip wheel setuptools</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pip3 install --upgrade acryl-datahub</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub version</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># If you see &quot;command not found&quot;, try running this instead: python3 -m datahub version</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Once the prerequisites had been installed we needed to install the specific plugin that we need in order to be able to
ingest data from the data platform. In this case we installed the glue plugin which allowed us to ingest data from the
Glue data catalogue.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><pre tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">pip3 install &#x27;acryl-datahub[glue]&#x27; # install the required plugin</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub check plugins</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Once the prerequisites and the required plugins are installed you can then ingest the data from the glue catalogue by locate and update the glue_to_datahub.yml metadata ingestion example receipe which can be found here: <a href="https://github.com/linkedin/datahub/blob/master/metadata-ingestion/examples/recipes/glue_to_datahub.yml" target="_blank" rel="noopener noreferrer">/metadata-ingestion/examples/recipes/glue_to_datahub.yml</a></p><p>The contents of which should look as below:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># see https://datahubproject.io/docs/metadata-ingestion/source_docs/glue for complete documentation</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  type: glue</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  config:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    aws_region: &quot;us-west-2&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    extract_transforms: true</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># see https://datahubproject.io/docs/metadata-ingestion/sink_docs/datahub for complete documentation</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sink:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  type: &quot;datahub-rest&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  config:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    server: &quot;http://localhost:8080&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You will need to update the following properties:</p><ul><li><code>source -&gt; config -&gt; aws_region</code></li><li><code>sink -&gt; config -&gt; server</code></li></ul><p>With values which reflect the staging environment. One you have updated the recipe configuration you can run the
ingestion with the following command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh/"><pre tabindex="0" class="prism-code language-sh/ codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub ingest -c ./metadata-ingestion/examples/recipes/glue_to_datahub.yml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="dns-configuration"></a>DNS configuration<a class="hash-link" href="#dns-configuration" title="Direct link to heading">#</a></h4><p>When setting up the DataHub data catalogue site we required both a security certificate and a domain name to be associatable with the Kubernetes cluster.</p><p>To accomplish this we:</p><ul><li>Created a Name Server (NS) record on the Hackney domain for the data.hackney.gov.uk sub-domain. <a href="https://github.com/LBHackney-IT/infrastructure/pull/456/files#diff-ca01997613717d7b58e624d2faf9e939b9e1bc8debc83fd01c85158003b7d8ac" target="_blank" rel="noopener noreferrer">Pull Request</a><ul><li>This granted the production Data Platform account control over the sub-domain.</li></ul></li><li>Created a Name Server (NS) record on the data.hackney.gov.uk Hosted Zone for the stg.data.hackney.gov.uk sub-domain.<ul><li>This granted the staging Data Platform account control over the sub-domain.</li></ul></li><li>Created a CName record on the stg.data.hackney.gov.uk Hosted Zone for the datahub.stg.data.hackney.gove.uk sub-domain that points at the Kubernetes cluster.</li><li>Using AWS Certificate Manager created a security certificate for datahub.stg.data.hackney.gove.uk by DNS validation.<ul><li>A guide to creating a certificate is referenced by the datahub setup guide and can be found here: <a href="https://docs.aws.amazon.com/acm/latest/userguide/gs-acm-request-public.html" target="_blank" rel="noopener noreferrer">Create Certificate</a></li></ul></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/LBHackney-IT/data-platform-playbook/edit/master/docs/spikes/datahub-deployment.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Data-Platform-Playbook/spikes/data-quality-testing"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Data Quality Testing</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Data-Platform-Playbook/spikes/mssql-ingestion"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Ingesting data from MSSQL database Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#objective" class="table-of-contents__link">Objective</a></li><li><a href="#considerations" class="table-of-contents__link">Considerations</a></li><li><a href="#findings" class="table-of-contents__link">Findings</a><ul><li><a href="#dockercontainer-setup-via-compose-ecs-fargate-etc" class="table-of-contents__link">Docker/container setup (via compose, ECS, Fargate etc)</a></li><li><a href="#sso" class="table-of-contents__link">SSO</a></li><li><a href="#role-based-access-control" class="table-of-contents__link">Role Based Access Control</a></li></ul></li><li><a href="#summary" class="table-of-contents__link">Summary</a></li><li><a href="#helpful-resources--documentation" class="table-of-contents__link">Helpful Resources / Documentation</a><ul><li><a href="#deploying-to-ec2" class="table-of-contents__link">Deploying to EC2</a></li><li><a href="#deploying-to-eks" class="table-of-contents__link">Deploying to EKS</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Made by HackIT.</div></div></div></footer></div>
<script src="/Data-Platform-Playbook/assets/js/runtime~main.ccb51e9d.js"></script>
<script src="/Data-Platform-Playbook/assets/js/main.ef2f8cd2.js"></script>
</body>
</html>