<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-playbook/transforming-data/using-aws-glue/using-glue-studio">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<link rel="search" type="application/opensearchdescription+xml" title="Hackney Data Platform Playbook" href="/Data-Platform-Playbook/opensearch.xml"><title data-rh="true">Using Glue Studio | Hackney Data Platform Playbook</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://playbook.hackney.gov.uk//Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/using-glue-studio"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Using Glue Studio | Hackney Data Platform Playbook"><meta data-rh="true" name="description" content="Using AWS Glue Studio to create ETL processes."><meta data-rh="true" property="og:description" content="Using AWS Glue Studio to create ETL processes."><link data-rh="true" rel="icon" href="/Data-Platform-Playbook/img/favicon.png"><link data-rh="true" rel="canonical" href="https://playbook.hackney.gov.uk//Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/using-glue-studio"><link data-rh="true" rel="alternate" href="https://playbook.hackney.gov.uk//Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/using-glue-studio" hreflang="en"><link data-rh="true" rel="alternate" href="https://playbook.hackney.gov.uk//Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/using-glue-studio" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://KNMFHOJ4X2-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/Data-Platform-Playbook/assets/css/styles.4438b1b5.css">
<link rel="preload" href="/Data-Platform-Playbook/assets/js/runtime~main.f34453f0.js" as="script">
<link rel="preload" href="/Data-Platform-Playbook/assets/js/main.57a1f352.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Data-Platform-Playbook/"><div class="navbar__logo"><img src="/Data-Platform-Playbook/img/logo-long.svg" alt="Data Platform Playbook" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/Data-Platform-Playbook/img/logo-long.svg" alt="Data Platform Playbook" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title text--truncate">Data Platform Playbook</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/LBHackney-IT/data-platform-playbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_dLyj"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_mKqt"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><div class="docPage_ualW"><aside class="theme-doc-sidebar-container docSidebarContainer_UQUJ"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/Data-Platform-Playbook/playbook/getting-set-up">Playbook</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/getting-set-up">Getting set up on the platform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/elements-of-the-platform/data-catalogue">Elements of the platform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/finding-data/data-catalogue">Finding data on the platform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/getting-access-to-data/Tableau-to-redshift">Getting access to data</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/what-data-are-we-ingesting">Ingesting data</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/Data-Platform-Playbook/playbook/transforming-data/guides-to-testing-in-the-platform/data-quality-testing-guide">Transforming data</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/transforming-data/guides-to-testing-in-the-platform/data-quality-testing-guide">Guides to testing in the platform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/using-glue-studio">Using AWS Glue</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/using-glue-studio">Using Glue Studio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/deploy-glue-jobs">Deploying Glue jobs to the Data Platform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/using-sagemaker">Prototyping glue jobs in a notebook</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/practical-examples/scheduling-liberator-glue-jobs">Practical examples</a></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/querying-and-analysing-data/connecting-to-redshift-from-data-studio">Querying and analysing data</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/training-modules/module-0">Training Modules</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/docs/CD-process">Technical Documentation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/architecture-decisions">Architecture Decision</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/spikes/amundsen-deployment">Spikes</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Data-Platform-Playbook/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Data-Platform-Playbook/roles">Roles</a></li></ul></nav></div></aside><main class="docMainContainer_uL0j"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/Data-Platform-Playbook/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_kU5B"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Playbook</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Transforming data</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Using AWS Glue</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Using Glue Studio</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_bZGK theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_l22C">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Using Glue Studio</h1></header><h2 class="anchor anchorWithStickyNavbar_mojV" id="using-aws-glue-studio-to-create-etl-processes">Using AWS Glue Studio to create ETL processes<a class="hash-link" href="#using-aws-glue-studio-to-create-etl-processes" title="Direct link to heading">​</a></h2><div class="admonition admonition-important alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</h5></div><div class="admonition-content"><p>The aim of this guide is to help you get started in creating and testing your Glue jobs.</p><p>Once your Glue job is ready and working as expected, you can refer to <a href="/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/deploy-glue-jobs">this guide</a>
to deploy your Glue job to the Data Platform Production environment. You should keep your original Glue job (which was created in Glue Studio) should you need to make further improvements to it in the future
and refer to the note at the bottom of <a href="/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/deploy-glue-jobs#1-add-your-script-to-the-data-platform-project-using-the-github-ui">section 1</a> of <strong>Deploying Glue jobs to the Data Platform</strong>, to re-deploy the new version to the Data Platform Production environment.</p></div></div><p><a href="https://docs.aws.amazon.com/glue/latest/ug/what-is-glue-studio.html" target="_blank" rel="noopener noreferrer">AWS Glue Studio</a> is a new graphical interface that makes it easy to create, run, and monitor extract, transform, and load (ETL) jobs in AWS Glue.</p><p>To use AWS Glue Studio the job needs to be created manually. This guide includes the steps needed to create an editable job in Glue Studio. Templates may have already been created and existing jobs can be duplicated to make it easier to get started with Glue Studio. Dynamically created scripts using <a href="https://www.terraform.io/" target="_blank" rel="noopener noreferrer">terraform</a> (the infrastructure as code tool Hackney use) will not have the ability to use the visual editor.</p><p>Note: If a job has already been created manually you can select the job using the radio button and in the job <em>Actions</em> mennu, select <strong>Clone job</strong>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="creating-a-new-glue-job">Creating a new Glue job<a class="hash-link" href="#creating-a-new-glue-job" title="Direct link to heading">​</a></h2><p>Note: The instructions below assume an S3 Data Source and Target Location.</p><ol><li>Log in to AWS Management Console.</li><li>Select the <strong>AWS Glue</strong> service from the services menu (or search field).</li><li>From the AWS Glue menu ETL section, select <strong>AWS Glue Studio</strong>.</li><li>From the AWS Glue Studio main page, choose the <strong>Create and manage jobs</strong> option.</li><li>Within the <em>Create Job</em> section, select <strong>Source and target added to the graph</strong> and select desired Source and Target values.</li><li>Click the <strong>Create</strong> button.</li><li>In the Visual editor that is now displayed, click on the <em>Data Source - S3</em> box and in the <em>Data source properties - S3</em> tab to set <em>S3 source type</em> to <strong>S3 location</strong> and set the <em>S3 URL</em> for the source data. To reduce the time your job takes to run, you can follow <a href="#pre-filter-your-source-data-for-a-glue-job">these steps</a> to pre-filter the source data passed to your transformation step.</li><li>Also <em>Data Target - S3</em> box and in the <em>Data target properties - S3</em> tab set the <em>S3 URL</em> for the data target, usually your department folder in the Data Platform account.
<em>NB: You can add additional folders at this point for your new data within your department folder. Each department has an unrestricted directory within each zone where unrestricted datasets can be stored, in order to add further cross-department insights and maintain datasets. There is also an unrestricted department which allows users to maintain datasets which don&#x27;t have access restrictions across each zone</em><strong>Data source and data target (amongst other operations) must be set to be able to save the job. You can also apply <em>Transformations</em> specific to your job via the Visual tab. See the <a href="https://docs.aws.amazon.com/glue/latest/ug/edit-nodes-chapter.html" target="_blank" rel="noopener noreferrer">AWS Glue Studio Documentation</a></strong>.</li><li>To complete the set up you need to select the <strong>Job details</strong> tab.</li><li>Complete the <em>Name</em> and optional <em>Description</em> fields. You may use this job as a template for repeat use, so a generic name to use as a template might be useful to begin with.</li><li>Select <strong>dataplatform-{environment}-glue-role</strong> where environment is either &#x27;stg&#x27; or &#x27;prod&#x27;; as the <em>IAM Role</em> for the job.</li><li>The remaining standard fields default values are usually fine to use. The programming language Glue Studio creates can be Scala or Python.</li><li>In <em>Advanced properties</em> check the <em>Script filename</em> refers to the task being carried out.</li><li>Set the <em>Script path</em> to the central scripts S3 bucket: <code>s3://dataplatform-{environment}-glue-scripts/custom/</code> where environment is either &#x27;stg&#x27; or &#x27;prod&#x27; - you can create new folders or specify existing folders in the S3 bucket like this: <code>s3://dataplatform-{environment}-glue-scripts/custom/YOUR_FOLDER_NAME/</code>.</li><li>Set the <em>Temporary path</em> to the central temp storage S3 bucket: <code>s3://dataplatform-{environment}-glue-temp-storage/</code> where environment is either &#x27;stg&#x27; or &#x27;prod&#x27;.</li><li>In <em>Security configuration</em> select the appropriate security configuration for your target bucket location (for example for the Raw Zone, use <strong>glue-job-security-configuration-to-raw</strong>).</li><li>Ensure the <em>Server-side encryption</em> option is <strong>not checked</strong>, so that it uses the buckets default encryption configuration.</li><li>In the <em>Tags</em> section, add the key <code>PlatformDepartment</code> and set the value as the name of your department.
This should be the same name which was used to set up the department on the <a href="https://github.com/LBHackney-IT/Data-Platform/blob/main/terraform/core/05-departments.tf" target="_blank" rel="noopener noreferrer">Data Platform</a>.</li><li>Add any further libraries or parameters you need in the <em>Advanced properties</em> section.</li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="note-exporting-data">Note: Exporting Data<a class="hash-link" href="#note-exporting-data" title="Direct link to heading">​</a></h3><p>When exporting data from your Glue Job it is important that you follow the Data Platforms partitioning stratagy. To do this, exports must be exported with the partitions import_year, import_month, import_day &amp; import_date at a minimum. To accomplish this using AWS Glue Studio use the <code>Add a partition</code> key option at the bottom of the Data target node. It is important to further note, that inorder to add these attributes as partitions, they must exist within the dataset as fields.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="clone-and-edit-an-existing-glue-job">Clone and edit an existing Glue job<a class="hash-link" href="#clone-and-edit-an-existing-glue-job" title="Direct link to heading">​</a></h2><ol><li>In the <em>Your jobs</em> sections, select the radio button of the job you would like to clone.</li><li>In the <em>Actions</em> dropdown, select <em>Clone job</em>. If there is an information banner with a message <em>Your job was created outside of Glue Studio and has no DAG available</em> (see screenshot below) there will not be a Visual tab and therefore you will not have an interface to edit your job. Instead you will need to edit your job in the python job script. To do this navigate to the <em>Script</em> tab. If you prefer to use the interface, then select another job which has a Visual tab or create a new job as instructed in the <em>Creating a new Glue job</em> section above.
<img loading="lazy" src="https://user-images.githubusercontent.com/46002877/114702251-bcac0500-9d1b-11eb-8475-814523fd58dc.png" alt="image" class="img_E7b_"></li><li>In the Job Details tab, update the <em>Name</em> for your new job and check the <em>Creating a new Glue job</em> seciton above to ensure the configuration suits your needs.</li><li>To save your job, select the <strong><em>Save</em></strong> button.</li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="pre-filter-your-source-data-for-a-glue-job">Pre-filter your source data for a glue job<a class="hash-link" href="#pre-filter-your-source-data-for-a-glue-job" title="Direct link to heading">​</a></h2><p>By default, AWS glue will load all source data for a job before running the transformation steps.
If the transformation is only interested in a subset of the data partitions, you can use a pushdown predicate to tell the glue job only to consider these partitions.
If you have a large data set, this could have substantial performance benefits for your glue jobs (i.e. it will reduce the time it takes them to run).</p><p>Follow these steps to set this in Glue Studio.</p><ol><li>Navigate to the visual tab when viewing your glue job in glue studio.</li><li>Select a &quot;Data source&quot; node.</li><li>Staying in the &quot;Data source properties - S3&quot; tab, you should see the field &quot;Partition predicate - optional&quot;, enter your predicate expression here.</li></ol><p>The predicate must be Spark SQL syntax; Glue Studio provides an example of a predicate in the UI.
Here is an example that only keeps records where the import_date (a standard partition used within the Data Platform) is within the last seven days.</p><div class="language-sql codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-sql codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  to_date</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">import_date</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;yyyyMMdd&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;=</span><span class="token plain"> date_sub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">current_date</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">7</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For further reading around pushdown predicates and partitioned data in Glue jobs, AWS have some <a href="https://docs.aws.amazon.com/glue/latest/dg/aws-glue-programming-etl-partitions.html" target="_blank" rel="noopener noreferrer">documentation</a> on their use in AWS Glue ETL&#x27;s and a <a href="https://aws.amazon.com/blogs/big-data/work-with-partitioned-data-in-aws-glue/" target="_blank" rel="noopener noreferrer">blog post about working with partitioned data</a>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="monitoring-a-glue-job-run">Monitoring a glue job run<a class="hash-link" href="#monitoring-a-glue-job-run" title="Direct link to heading">​</a></h2><p>We recommend that you enable continuous logging on your glue jobs, you can read more about this in <a href="https://docs.aws.amazon.com/glue/latest/dg/monitor-continuous-logging.html" target="_blank" rel="noopener noreferrer">AWS&#x27;s documentation</a>.
Enabling continuous logging will allow you to <a href="https://docs.aws.amazon.com/glue/latest/dg/monitor-continuous-logging-view.html" target="_blank" rel="noopener noreferrer">view logs</a> after your glue job has started. </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="continuous-logging">Continuous logging<a class="hash-link" href="#continuous-logging" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="enabling-continuous-logging">Enabling continuous logging<a class="hash-link" href="#enabling-continuous-logging" title="Direct link to heading">​</a></h4><p>To enable continous logging you need to check the &quot;Continuous logging&quot; box in the &quot;Advanced properties&quot; section of the job details.
<img loading="lazy" alt="continous looging checkbox" src="/Data-Platform-Playbook/assets/images/glue_studio_cont_log_checkbox-8dd5bb41f25b1dc618ffd207b8615093.png" width="804" height="164" class="img_E7b_"></p><h4 class="anchor anchorWithStickyNavbar_mojV" id="viewing-logs-with-continuous-logging-enabled">Viewing logs with continuous logging enabled<a class="hash-link" href="#viewing-logs-with-continuous-logging-enabled" title="Direct link to heading">​</a></h4><p>To view the logs, navigate to the <code>Runs</code> tab and click on &quot;All logs&quot; under &quot;Cloudwatch logs&quot; in the run details, highlighted in the image below.
<img loading="lazy" alt="glue job run details" src="/Data-Platform-Playbook/assets/images/glue_run_details-520527963baa9712f891b41dff95b501.png" width="2594" height="956" class="img_E7b_">
This will take you to the list of logs streams for that job run.
There will be one for each executor of the job, including the driver, most of the time the driver logs will hold the most helpful information.
The driver logs are in the stream postfixed by -driver, like in the screenshot below.
<img loading="lazy" alt="list of log streams for all logs" src="/Data-Platform-Playbook/assets/images/glue_all_log_streams-ee80964cac77c35a7868df990d21acb0.png" width="2261" height="608" class="img_E7b_">
You can click on this log stream to see the logs. </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="when-a-glue-job-errors">When a glue job errors<a class="hash-link" href="#when-a-glue-job-errors" title="Direct link to heading">​</a></h3><p>Even without continuous logging you can still view the full error output after a glue job has failed.
On the run details page it will only show a truncated version of the error message, often hiding the underlying error.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="viewing-error-logs">Viewing error logs<a class="hash-link" href="#viewing-error-logs" title="Direct link to heading">​</a></h4><p>To view the error logs click on &quot;Error logs&quot; under &quot;Cloudwatch logs&quot; in the run details, highlighted in the <a href="#viewing-logs-with-continuous-logging-enabled">image above</a>.
This will take you to a list of logs streams for that job run.
There will be one for each executor of the job, including the driver, most of the time the driver logs will hold the most helpful information.
You can open up the logs for the driver by selecting the log stream which isn&#x27;t postfixed by a second identifier.
The driver log stream is highlighted in the sreenshot below.
<img loading="lazy" alt="list of log streams for errors" src="/Data-Platform-Playbook/assets/images/glue_error_log_streams-31776ca3709521c433aa33ff00843d33.png" width="2290" height="492" class="img_E7b_">
You may need to expand the log stream column size in order to see this.
Click on the driver logs to see the full error output and stack trace.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="finding-the-error-in-the-error-logs">Finding the error in the error logs<a class="hash-link" href="#finding-the-error-in-the-error-logs" title="Direct link to heading">​</a></h4><p>There will be a lot of logs, most will be be for information, marked &quot;INFO&quot;, you should looks at the ones marked with &quot;ERROR&quot;.
There may still be a couple marked &quot;ERROR&quot; so you should consider them all when looking for the error that caused your glue job to fail.</p><p>For an example, if you <a href="https://hackney.awsapps.com/start#/" target="_blank" rel="noopener noreferrer">login to the pre-production AWS account</a> then navigate to <a href="https://eu-west-2.console.aws.amazon.com/cloudwatch/home?region=eu-west-2#logsV2:log-groups/log-group/$252Faws-glue$252Fjobs$252Fdataplatform-stg-config-to-refined-role$252Fdataplatform-stg-glue-parking$252Ferror/log-events/jr_e7713ac7cf766da842d6e2e84479d508bda6013b28dc409344a77e6af796aa5b_attempt_1" target="_blank" rel="noopener noreferrer">these logs</a>.
Looking from the bottom of the logs you first come accross an ERROR log that is mentioning an S3 Access Denied error (you can click the little arrow on the left to expand the message).
This is an error with pushing the logs and isn&#x27;t the reason the glue job failed.
If you then scroll up a bit to the next ERROR, it contains a message that mentions &quot;Error from Python:Traceback &quot; and then follows on to give the stacktrace for the SQL error &quot;DataType varchar is not supported.(line 54, pos 45)&quot;.
This is the error which has failed the glue job.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="receive-email-notifications-when-glue-jobs-fail">Receive email notifications when Glue jobs fail<a class="hash-link" href="#receive-email-notifications-when-glue-jobs-fail" title="Direct link to heading">​</a></h2><p>Each time a Glue job fails, an email notification with details of the error message is sent to the respective department, and their subscribed members.</p><p>The message will include:</p><ul><li>Name of the Glue job</li><li>Error message</li><li>Time of failure</li><li>Job start time</li><li>Job end time</li><li>Job last modified time</li><li>A link to log in to Hackney SSO and view the Job run details</li></ul><p>In order to receive email notifications, you will need to ensure that you are subscribed to receive emails from your department&#x27;s <a href="https://groups.google.com/my-groups" target="_blank" rel="noopener noreferrer">Google group</a> and that you have confirmed your subscription to receive AWS Notifications when prompted.</p><p>Additionally, Spark Web UI is used to monitior and debug the glue jobs. Every 30 seconds, AWS Glue flushes the Spark event logs to an S3 bucket titled Spark UI Bucket.</p><div class="admonition admonition-important alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</h5></div><div class="admonition-content"><p>Ensure the <strong>PlatformDepartment</strong> tag is correctly set in the <em>Advanced details</em> section in the Glue job&#x27;s <em>Job Details</em> (see <a href="#creating-a-new-glue-job">Creating a new Glue job</a> section above).</p></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/Data-Platform-Playbook/tags/playbook">playbook</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/LBHackney-IT/data-platform-playbook/edit/master/docs/playbook/transforming-data/using-aws-glue/001-using-glue-studio.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/Data-Platform-Playbook/playbook/transforming-data/guides-to-testing-in-the-platform/unit-testing-guide"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Guide to unit testing on the Data Platform</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/deploy-glue-jobs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Deploying Glue jobs to the Data Platform</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#using-aws-glue-studio-to-create-etl-processes" class="table-of-contents__link toc-highlight">Using AWS Glue Studio to create ETL processes</a></li><li><a href="#creating-a-new-glue-job" class="table-of-contents__link toc-highlight">Creating a new Glue job</a><ul><li><a href="#note-exporting-data" class="table-of-contents__link toc-highlight">Note: Exporting Data</a></li></ul></li><li><a href="#clone-and-edit-an-existing-glue-job" class="table-of-contents__link toc-highlight">Clone and edit an existing Glue job</a></li><li><a href="#pre-filter-your-source-data-for-a-glue-job" class="table-of-contents__link toc-highlight">Pre-filter your source data for a glue job</a></li><li><a href="#monitoring-a-glue-job-run" class="table-of-contents__link toc-highlight">Monitoring a glue job run</a><ul><li><a href="#continuous-logging" class="table-of-contents__link toc-highlight">Continuous logging</a></li><li><a href="#when-a-glue-job-errors" class="table-of-contents__link toc-highlight">When a glue job errors</a></li></ul></li><li><a href="#receive-email-notifications-when-glue-jobs-fail" class="table-of-contents__link toc-highlight">Receive email notifications when Glue jobs fail</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Made by HackIT.</div></div></div></footer></div>
<script src="/Data-Platform-Playbook/assets/js/runtime~main.f34453f0.js"></script>
<script src="/Data-Platform-Playbook/assets/js/main.57a1f352.js"></script>
</body>
</html>