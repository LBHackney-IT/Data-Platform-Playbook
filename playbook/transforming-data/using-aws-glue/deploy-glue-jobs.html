<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-playbook/transforming-data/using-aws-glue/deploy-glue-jobs">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Deploying Glue jobs to the Data Platform | Hackney Data Platform Playbook</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://playbook.hackney.gov.uk/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/deploy-glue-jobs"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Deploying Glue jobs to the Data Platform | Hackney Data Platform Playbook"><meta data-rh="true" name="description" content="Creating Glue jobs in terraform"><meta data-rh="true" property="og:description" content="Creating Glue jobs in terraform"><link data-rh="true" rel="icon" href="/Data-Platform-Playbook/img/favicon.png"><link data-rh="true" rel="canonical" href="https://playbook.hackney.gov.uk/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/deploy-glue-jobs"><link data-rh="true" rel="alternate" href="https://playbook.hackney.gov.uk/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/deploy-glue-jobs" hreflang="en"><link data-rh="true" rel="alternate" href="https://playbook.hackney.gov.uk/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/deploy-glue-jobs" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://KNMFHOJ4X2-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Hackney Data Platform Playbook" href="/Data-Platform-Playbook/opensearch.xml"><link rel="stylesheet" href="/Data-Platform-Playbook/assets/css/styles.e0b8b3cc.css">
<link rel="preload" href="/Data-Platform-Playbook/assets/js/runtime~main.805040e5.js" as="script">
<link rel="preload" href="/Data-Platform-Playbook/assets/js/main.f7d52c65.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Data-Platform-Playbook/"><div class="navbar__logo"><img src="/Data-Platform-Playbook/img/logo-long.svg" alt="Data Platform Playbook" class="themedImage_ToTc themedImage--light_HNdA"><img src="/Data-Platform-Playbook/img/logo-long.svg" alt="Data Platform Playbook" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Data Platform Playbook</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/LBHackney-IT/data-platform-playbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/Data-Platform-Playbook/playbook/getting-set-up">Playbook</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/getting-set-up">Getting set up on the platform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/elements-of-the-platform/data-catalogue">Elements of the platform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/finding-data/data-catalogue">Finding data on the platform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/getting-access-to-data/Tableau-to-redshift">Getting access to data</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/what-data-are-we-ingesting">Ingesting data</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/Data-Platform-Playbook/playbook/transforming-data/guides-to-testing-in-the-platform/data-quality-testing-guide">Transforming data</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/transforming-data/guides-to-testing-in-the-platform/data-quality-testing-guide">Guides to testing in the platform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/using-glue-studio">Using AWS Glue</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/using-glue-studio">Using Glue Studio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/deploy-glue-jobs">Deploying Glue jobs to the Data Platform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/using-sagemaker">Prototyping glue jobs in a notebook</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/optimizing-glue-jobs">Optimizing Glue jobs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/practical-examples/scheduling-liberator-glue-jobs">Practical examples</a></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/querying-and-analysing-data/time-series-analysis/introduction">Querying and analysing data</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/training-modules/module-0">Training Modules</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/docs/CD-process">Technical Documentation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/architecture-decisions">Architecture Decision</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/spikes/amundsen-deployment">Spikes</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Data-Platform-Playbook/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Data-Platform-Playbook/roles">Roles</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/Data-Platform-Playbook/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Playbook</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Transforming data</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Using AWS Glue</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Deploying Glue jobs to the Data Platform</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Deploying Glue jobs to the Data Platform</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploying-glue-jobs-to-the-data-platform-using-the-glue-jobs-terraform-template">Deploying Glue jobs to the Data Platform using the Glue jobs Terraform template<a href="#deploying-glue-jobs-to-the-data-platform-using-the-glue-jobs-terraform-template" class="hash-link" aria-label="Direct link to Deploying Glue jobs to the Data Platform using the Glue jobs Terraform template" title="Direct link to Deploying Glue jobs to the Data Platform using the Glue jobs Terraform template">​</a></h2><div class="theme-admonition theme-admonition-important alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>This guide contains instructions on how to deploy your Glue job to the Data Platform using the GitHub UI.
It assumes you have finished developing your script, and it is ready to be deployed to the Data Platform Production environment.
If you are still testing or prototyping your script, it is recommended that you refer to <a href="/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/using-glue-studio">this guide</a> first.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-add-your-script-to-the-data-platform-project-using-the-github-ui">1. Add your script to the Data Platform Project using the GitHub UI<a href="#1-add-your-script-to-the-data-platform-project-using-the-github-ui" class="hash-link" aria-label="Direct link to 1. Add your script to the Data Platform Project using the GitHub UI" title="Direct link to 1. Add your script to the Data Platform Project using the GitHub UI">​</a></h3><ol><li>Navigate to the <a href="https://github.com/LBHackney-IT/Data-Platform/tree/main/scripts/jobs" target="_blank" rel="noopener noreferrer">jobs directory</a> in the Data Platform Project and open your department folder.</li><li>Click <code>Add file</code> and then <code>Create new file</code>.</li><li>Name your file.
This should be the same name you gave your job in Glue Studio.
Ensure the file name only contains <strong>lowercase letters</strong>, <strong>words are separated by underscores</strong>, and has the extension <strong><code>.py</code></strong> at the end.
For example: <code>address_cleaning_housing_repairs.py</code>.<ul><li><em>Remember this name as you will need it for the following section.</em></li></ul></li><li>If your Glue job was created using Glue Studio, open your Glue job and copy the auto generated <strong>Python</strong> script by navigating to the <code>Script</code> tab.</li><li>Navigate back to the new script file you created in the GitHub UI (or existing script file, if you are updating your script), and paste your script.</li><li>Submit your changes by referring to the <a href="/Data-Platform-Playbook/playbook/getting-set-up/using-github#committing-your-changes-to-the-data-platform-project">Committing changes</a> section of the <strong>Using Github</strong> guide.
The Data Platform team needs to approve any changes to the code, so your change won&#x27;t happen automatically.</li></ol><div class="theme-admonition theme-admonition-important alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Updating your Glue job script</div><div class="admonitionContent_S0QG"><p>If you need to update your Glue job script in the future, you must follow steps 4-6 to have those changes deployed to the Data Platform Project.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-copy-an-existing-glue-job-module-block-or-use-the-example-below-and-populate-the-necessary-variables">2. Copy an existing Glue job module block or use the example below and populate the necessary variables<a href="#2-copy-an-existing-glue-job-module-block-or-use-the-example-below-and-populate-the-necessary-variables" class="hash-link" aria-label="Direct link to 2. Copy an existing Glue job module block or use the example below and populate the necessary variables" title="Direct link to 2. Copy an existing Glue job module block or use the example below and populate the necessary variables">​</a></h3><p>In this section, you will be writing the code, using a template format, that will deploy your Glue job (and crawler) to the Data Platform Project (or update an existing one if you need to make changes to an existing Glue job).
You can view a complete example <a href="#example-module-block">here</a>.</p><ol><li><p>Open the <a href="https://github.com/LBHackney-IT/Data-Platform/tree/main/terraform/etl" target="_blank" rel="noopener noreferrer">terraform/etl directory</a> in the Data Platform Project in GitHub.</p><ul><li>If you don&#x27;t have the correct permissions, you&#x27;ll get a &#x27;404&#x27; error (see <a href="/Data-Platform-Playbook/playbook/ingesting-data/google-sheets-import#prerequisites">prerequisites</a>).</li></ul></li><li><p>Open <code>25-aws-glue-jobs-&lt;YOUR-DEPARTMENT-NAME&gt;.tf</code>. e.g. <code>38-aws-glue-job-parking.tf</code></p><ul><li><em>If this file does not exist, create a new terraform file for your department by clicking <code>Add file</code> then <code>Create new file</code>.
The name of the new file should be:</em></li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">25-aws-glue-jobs-&lt;YOUR-DEPARTMENT-NAME&gt;.tf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><em>Refer to the <a href="#example-module-block">example</a> below to get started.</em></li></ul></li><li><p>Click <code>edit</code> or the <strong>pencil icon</strong> (✏️) then copy the last module block and paste it at the bottom of the file.
An example of what a module block looks like can be seen <a href="https://github.com/LBHackney-IT/Data-Platform/blob/main/terraform/etl/38-aws-glue-job-parking.tf#L31-L44" target="_blank" rel="noopener noreferrer">here</a>.</p></li><li><p>Update the <code>module</code> name using the name convention <code>&lt;job_name&gt;_&lt;department_name&gt;</code>, for example: <code>&quot;manually_uploaded_csv_data_to_raw_parking&quot;</code>.</p><ul><li>The <code>&lt;job_name&gt;</code> here must be the same as the script name you specified in the <a href="#1-add-your-script-to-the-data-platform-project-using-the-github-ui">previous section</a> (without the <code>.py</code> extension).</li><li>The final module name (<code>&lt;job_name&gt;_&lt;department_name&gt;</code>) must be all <strong>lowercase</strong> with <strong>words separated by underscores</strong>.
Ensure the name is unique to all other module names in this file.</li><li><em><strong>Note:</strong> If your department name is already in the name of your Glue job, you do not need to repeat it in the module name
and can just name the module after your <code>&lt;job_name&gt;</code>.</em></li></ul></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="update-or-add-your-input-variables">Update or add your input variables.<a href="#update-or-add-your-input-variables" class="hash-link" aria-label="Direct link to Update or add your input variables." title="Direct link to Update or add your input variables.">​</a></h4><p>For this section, you will need the following values from your Glue job if applicable.
You can find them by navigating to the <code>Job Details</code> tab of your job in Glue Studio.</p><ul><li><strong>Name</strong></li><li><strong>Description</strong></li><li><strong>Job bookmark</strong>. The value of this will either be <code>Enable</code> or <code>Disable</code>.</li><li><strong>Job parameters</strong>. Expand the <code>Advanced properties</code> section and scroll down to <code>Job parameters</code>.</li></ul></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-following-input-variables-are-required">The following input variables are required:<a href="#the-following-input-variables-are-required" class="hash-link" aria-label="Direct link to The following input variables are required:" title="Direct link to The following input variables are required:">​</a></h4><p><em><strong>Note</strong>: If you&#x27;ve copied an existing module block from your department folder then you won’t need to change the <strong>source</strong>, <strong>department</strong>, <strong>helper_module_key</strong> and, <strong>pydeequ_zip_key</strong> variables and will only need to update the <strong>job_name</strong> variable.</em></p><p><em>If a variable is not needed you should delete the entire line in the module block.</em></p><ul><li><p><strong>source</strong> (required): This will be <code>&quot;../modules/aws_glue_job&quot;</code>. It is the path to where the Glue job module is saved within the repository.</p></li><li><p><strong>department</strong> (required): This will be <code>module.department_&lt;YOUR_DEPARTMENT_NAME&gt;</code></p><p><em>Note: the department name must be all lowercase and separated by underscores
e.g. <code>module.department_housing_repairs</code></em></p></li><li><p><strong>job_name</strong> (required): Name of the Glue job. Set this to the name of the script file you created in the previous section (without the <code>.py</code> extension)
and prefix it with <code>${local.short_identifier_prefix}</code>.</p><p>If the name of your Glue job doesn&#x27;t already have your department name, you should add it as a suffix here.
For example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">job_name = &quot;${local.short_identifier_prefix}address_cleaning_housing_repairs&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><strong>helper_module_key</strong> (required): This will be <code>aws_s3_bucket_object.helpers.key</code>. It is the S3 object key for the helpers python module.
This gives you access to all of the functions defined in the <a href="https://github.com/LBHackney-IT/Data-Platform/tree/main/scripts/helpers" target="_blank" rel="noopener noreferrer">helpers folder</a>. You can add new files or functions to the folder and they will be available in your glue jobs.</p></li><li><p><strong>pydeequ_zip_key</strong> (required): This will be <code>aws_s3_bucket_object.pydeequ.key</code>. It is the S3 object key for the PyDeequ python library, which is used for data quality testing in the Data Platform.</p></li><li><p><strong>spark_ui_output_storage_id</strong> (required): This will be <code>module.spark_ui_output_storage.bucket_id</code>. It is the S3 bucket ID where Spark UI Logs will be stored in order to monitor and debug the job.</p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="script-name-location-required">Script Name/ Location (required)<a href="#script-name-location-required" class="hash-link" aria-label="Direct link to Script Name/ Location (required)" title="Direct link to Script Name/ Location (required)">​</a></h4><p>One of the following variables must be populated: <strong>script_name</strong> OR <strong>script_s3_object_key</strong>.</p><p>If you are adding a new script to only be used for one Glue job you must provide a value for <strong>script_name</strong> and leave the second blank.
If your script file is already saved in S3 then you must provide a value for <strong>script_s3_object_key</strong>.</p><ul><li><p><strong>script_name</strong> : Name of the Glue job script. Set this to the name of the script file you created in <a href="#1-add-your-script-to-the-data-platform-project-using-the-github-ui">section 1</a> <strong>without the <code>.py</code> extension</strong> and ensure the name is all <strong>lowercase</strong>.
<em>This file must have been saved in your departmental folder.</em></p><p>For example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">script_name = &quot;address_cleaning_housing_repairs&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>Note: you must add quotes around the script name as shown in the example.</em></p></li><li><p><strong>script_s3_object_key</strong> : S3 object key of the script file.
If your script is used across multiple jobs it may already be saved in S3, in this case you can provide the key for that object within the scripts S3 bucket e.g. <code>aws_s3_bucket_object.address_matching.key</code>.</p></li></ul></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-following-input-variables-are-optional">The following input variables are optional:<a href="#the-following-input-variables-are-optional" class="hash-link" aria-label="Direct link to The following input variables are optional:" title="Direct link to The following input variables are optional:">​</a></h4><ul><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="variables-used-for-scheduling-a-glue-job">Variables used for scheduling a Glue job<a href="#variables-used-for-scheduling-a-glue-job" class="hash-link" aria-label="Direct link to Variables used for scheduling a Glue job" title="Direct link to Variables used for scheduling a Glue job">​</a></h4><p>To schedule your Glue job, you will need to set one of the following optional variables:
<strong>triggered_by_crawler</strong>, <strong>triggered_by_job</strong> or <strong>schedule</strong>.</p><p>The job created in this module will be triggered on completion of either
the crawler specified in <strong>triggered_by_crawler</strong>, the job specified in <strong>triggered_by_job</strong>, or the <strong>schedule</strong>.</p><p><em>Note: the placeholder variable <code>&lt;NAME_OF_GLUE_JOB_MODULE&gt;</code> used in <strong>trigger_by_job</strong> and <strong>triggered_by_crawler</strong>
refers to the existing Glue job module from which the job or crawler is being referenced.</em></p><ul><li><strong>triggered_by_crawler</strong> (optional): The Glue crawler that will trigger this job e.g.</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">triggered_by_crawler = module.&lt;NAME_OF_GLUE_JOB_MODULE&gt;.crawler_name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>From the <a href="#example-module-block">example template below</a>, the name of the Glue job module would be <code>manually_uploaded_csv_data_to_raw_parking</code>, and therefore you would write:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">triggered_by_crawler = module.manually_uploaded_csv_data_to_raw_parking.crawler_name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>triggered_by_job</strong> (optional): The Glue job that will trigger this job e.g.</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">triggered_by_job = module.&lt;NAME_OF_GLUE_JOB_MODULE&gt;.job_name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p><strong>schedule</strong> (optional): Schedule to run the Glue job specified using Cron expressions (see <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/events/ScheduledEvents.html#CronExpressions" target="_blank" rel="noopener noreferrer">AWS Cron Expression documentation</a>).</p><ul><li><p>For example, if you wanted your Glue job to run at 23:00:00pm, on every Monday, Tuesday, Wednesday, Thursday and Friday, every month,
your Cron expression would look like:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">schedule = &quot;cron(0 0 23 ? * MON,TUE,WED,THU,FRI *)&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>You can use <a href="https://www.freeformatter.com/cron-expression-generator-quartz.html" target="_blank" rel="noopener noreferrer">this tool</a> to generate your Cron expressions.</p></li></ul></li></ul></li><li><p><strong>job_description</strong> (optional): A description of the AWS Glue job e.g. &quot;Exports Google Sheets imported datasets to the landing zone&quot;</p></li><li><p><strong>extra_jars</strong> (optional): If your Glue job requires extra packages that are zipped in a JAR file, you can provide the list of the S3 path(s) to the JAR file(s) here.
For example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">extra_jars = [&quot;s3://${module.department_&lt;DEPARTMENT_NAME&gt;.glue_scripts_bucket.bucket_id}/&lt;JARS_FILE_NAME&gt;.jar&quot;, &quot;s3://${module.department_&lt;DEPARTMENT_NAME&gt;.glue_scripts_bucket.bucket_id}/&lt;JARS_FILE_NAME&gt;.jar&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>Note: ensure that your department name is all lowercase with words separated by underscores
e.g. replace <code>&lt;DEPARTMENT_NAME&gt;</code> with <code>housing_repairs</code>.</em></p></li><li><p><strong>job_parameters</strong> (optional): Here you can set some configuration for your Glue job or if your Glue job uses environment variables/ job parameters, you can set them here as well.</p><ul><li>You can find a list of optional Glue job configuration in <a href="https://docs.aws.amazon.com/glue/latest/dg/aws-glue-programming-etl-glue-arguments.html" target="_blank" rel="noopener noreferrer">AWS&#x27;s documentation</a>. A common one used in the Data Platform is <strong>job bookmarking</strong>. Which can be enabled like this:<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;--job-bookmark-option&quot; = &quot;job-bookmark-enable&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><em>Note: job bookmarking is disabled by default.</em></li></ul><p><strong>If your Glue job was created using the <code>Visual</code> tab in Glue Studio, you won&#x27;t need to set any other job parameters and can continue setting other input variables where necessary.</strong></p><ul><li><p>To retrieve the job parameters you set here, add this import statement to your script: <code>from scripts.helpers.helpers import get_glue_env_var</code></p><p>You can then get the value of your job parameters to use in your script like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">s3_target_location = get_glue_env_var(&#x27;s3_bucket_target&#x27;, &#x27;&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>In the following optional <strong>job parameters</strong>; <em>&quot;--s3_bucket_target&quot;</em>, <em>&quot;--s3_bucket_source&quot;</em> and <em>&quot;--source_catalog_database&quot;</em>:</p><ul><li><p><code>&lt;ZONE&gt;</code> refers to either: <code>raw</code>, <code>landing</code>, <code>refined</code>, or <code>trusted</code> S3 or Glue database zones.</p></li><li><p>Specifically for <em>&quot;--s3_bucket_source&quot;</em> and <em>&quot;--s3_bucket_target&quot;</em>, and any other S3 location path,
ensure that your department name and folder name is all <strong>lowercase</strong> and <strong>hyphen separated</strong> if necessary,
and that there is a <strong><code>&quot;/&quot;</code></strong> after the folder name (end of S3 path). For example, if your department is &quot;Housing Repairs&quot;, it
should be written as <code>housing-repairs</code>.</p><ul><li><p><em>&quot;--s3_bucket_source&quot;</em> (optional): the S3 source of the data used in the Glue job
e.g.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;--s3_bucket_source&quot; = &quot;s3://${module.&lt;ZONE&gt;_zone.bucket_id}/&lt;YOUR_DEPARTMENT_NAME&gt;/&lt;FOLDER_NAME&gt;/&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><em>&quot;--s3_bucket_target&quot;</em> (optional): the output S3 location for your Glue job
e.g.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;--s3_bucket_target&quot; = &quot;s3://${module.&lt;ZONE&gt;_zone.bucket_id}/&lt;YOUR_DEPARTMENT_NAME&gt;/&lt;FOLDER_NAME&gt;/&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><em>&quot;--source_catalog_database&quot;</em> (optional): the Glue database which contains the Glue <em>source_catalog table</em> needed for the Glue job
e.g.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;--source_catalog_database&quot; = module.department_&lt;YOUR_DEPARTMENT_NAME&gt;.&lt;ZONE&gt;_catalog_database_name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><em>Note: ensure that your department name is all <strong>lowercase</strong> with <strong>words separated by underscores</strong>
e.g. <code>housing_repairs</code>.</em></li></ul></li><li><p><em>&quot;--source_catalog_table&quot;</em> (optional): the Glue catalog source table of the data used in the Glue job
e.g.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;--source_catalog_table&quot; = &quot;housing_repairs_repairs_purdy&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><em>Note: if sourcing data from a catalog table, the </em><code>--source_catalog_database</code><em> job parameter must be set as well.</em></li></ul></li></ul></li></ul></li></ul><p>See the <a href="#example-module-block">example module</a> below for guidance on how to set your own job parameters.</p></li><li><p><strong>workflow_name</strong> (optional): An existing workflow to add the triggers to</p><ul><li><em>Note: this module <strong>does not</strong> create Glue workflows</em></li></ul></li><li><p><strong>crawler_details</strong> (optional): Inputs required to create a crawler. If this variable is not provided then no crawler will be created. These are:</p><ul><li><p><em>database_name</em>: Glue database where results are written</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">module.department_&lt;YOUR_DEPARTMENT_NAME&gt;.&lt;S3_BUCKET_ZONE&gt;_catalog_database_name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Where <code>&lt;S3_BUCKET_ZONE&gt;</code> can be either: <code>raw</code>, <code>landing</code>, <code>refined</code>, or <code>trusted</code></li></ul></li><li><p><em>s3_target_location</em>: The S3 location to be crawled.
This will likely be the same as the value of Glue job job parameter: <strong><code>--s3_bucket_target</code></strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;s3://${module.&lt;S3_BUCKET_ZONE&gt;_zone_bucket_id}/&lt;YOUR_DEPARTMENT_NAME&gt;/&lt;FOLDER_NAME&gt;/&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><em>table_prefix</em>: The table prefix used for catalog tables that are created in the specified Glue database (<strong>database_name</strong> variable set above) in <strong>Athena</strong>,
after crawling the <strong>s3_target_location</strong> e.g. <code>&quot;housing_repairs_&quot;</code></p></li><li><p><em>configuration</em> (Optional): By default, the <code>TableGroupingPolicy</code> will be set to <code>CombineCompatibleSchemas</code></p></li></ul></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-optional-input-variables">Advanced optional input variables:<a href="#advanced-optional-input-variables" class="hash-link" aria-label="Direct link to Advanced optional input variables:" title="Direct link to Advanced optional input variables:">​</a></h4><p>The default values for the following optional input variables are generally fine and don&#x27;t need to be changed.</p><ul><li><p><strong>max_concurrent_runs_of_glue_job</strong> (optional): Max number of concurrent runs for the Glue job. The is set to <strong>1</strong> by default.</p></li><li><p><strong>trigger_enabled</strong> (optional): Set to <strong><code>false</code></strong> to disable scheduled or conditional triggers for the Glue job.
This is set to <strong><code>true</code></strong> by default. <em>Note: the value of this variable does not need to be surrounded by quotes.</em></p></li><li><p><strong>glue_job_timeout</strong> (optional): The job timeout in minutes. By default this is set to 2880 minutes (48 hours).</p></li><li><h4 class="anchor anchorWithStickyNavbar_LWe7" id="optional-variables-used-for-configuring-the-capacity-a-glue-job">Optional variables used for configuring the capacity a Glue job<a href="#optional-variables-used-for-configuring-the-capacity-a-glue-job" class="hash-link" aria-label="Direct link to Optional variables used for configuring the capacity a Glue job" title="Direct link to Optional variables used for configuring the capacity a Glue job">​</a></h4><p>To change the capacity of your Glue job, you will need to set the following <strong>glue_job_worker_type</strong> and <strong>number_of_workers_for_glue_job</strong> variables.
In most instances, the default settings are fine, and you would only need to set or change these variables if your Glue job is processing very large datasets
or performing complex transformations.</p><ul><li><strong>number_of_workers_for_glue_job</strong> (optional): The number of workers to use for the Glue job. The is set to <strong>2</strong> by default.</li><li><strong>glue_job_worker_type</strong> (optional): Worker type for Glue job (see <a href="https://docs.aws.amazon.com/glue/latest/dg/add-job.html#:~:text=Own%20Custom%20Scripts.-,Worker%20type,-The%20following%20worker" target="_blank" rel="noopener noreferrer">AWS documentation on &#x27;Worker types</a>&#x27;). The default is <strong>Standard</strong>. This can either be set as &quot;Standard&quot;, &quot;G.1X&quot; or &quot;G.2X&quot;.</li></ul></li></ul><div class="theme-admonition theme-admonition-warning alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Before committing your changes, please check that:</div><div class="admonitionContent_S0QG"><ul><li>You have not changed any spacing before the <code>=</code> of input variables&#x27; values</li><li>You have not removed the <code>&quot;quotation marks&quot;</code> around any values which use them</li><li>All equal signs (<code>=</code>) line up as shown in the example below</li><li>Any unneeded variables are removed by deleting the entire line</li></ul></div></div><ol start="6"><li>Once you have finished creating your Glue job using the template and have populated all relevant variables,
submit your job for review by the Data Platform team by following <a href="/Data-Platform-Playbook/playbook/getting-set-up/using-github#committing-your-changes-to-the-data-platform-project">this guide</a>.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="example-module-block">Example module block<a href="#example-module-block" class="hash-link" aria-label="Direct link to Example module block" title="Direct link to Example module block">​</a></h2><div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">module &quot;manually_uploaded_csv_data_to_raw_parking&quot; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  source = &quot;../modules/aws-glue-job&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  department  = module.department_housing_repairs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  job_name    = &quot;${local.short_identifier_prefix}housing repairs address cleaning&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  script_name = &quot;address_cleaning_housing_repairs&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  schedule    = &quot;cron(0 23 ? * MON,TUE,WED,THU,FRI _)&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  job_parameters = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;--s3_bucket_source&quot; = &quot;${module.landing_zone.bucket_id}/manual/housing-repairs/repairs-axis/&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;--s3_bucket_target&quot; = &quot;${module.raw_zone.bucket_id}/housing-repairs/repairs-axis/&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  crawler_details = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    database_name      = module.department_housing_repairs.raw_zone_catalog_database_name</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    s3_target_location = &quot;s3://${module.raw_zone.bucket_id}/housing-repairs/repairs-axis/&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    table_prefix       = &quot;housing_repairs_&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Data-Platform-Playbook/tags/playbook">playbook</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/LBHackney-IT/data-platform-playbook/edit/master/docs/playbook/transforming-data/using-aws-glue/002-deploy-glue-jobs.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/using-glue-studio"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Using Glue Studio</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Data-Platform-Playbook/playbook/transforming-data/using-aws-glue/using-sagemaker"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Prototyping glue jobs in a notebook</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#deploying-glue-jobs-to-the-data-platform-using-the-glue-jobs-terraform-template" class="table-of-contents__link toc-highlight">Deploying Glue jobs to the Data Platform using the Glue jobs Terraform template</a><ul><li><a href="#1-add-your-script-to-the-data-platform-project-using-the-github-ui" class="table-of-contents__link toc-highlight">1. Add your script to the Data Platform Project using the GitHub UI</a></li><li><a href="#2-copy-an-existing-glue-job-module-block-or-use-the-example-below-and-populate-the-necessary-variables" class="table-of-contents__link toc-highlight">2. Copy an existing Glue job module block or use the example below and populate the necessary variables</a></li></ul></li><li><a href="#example-module-block" class="table-of-contents__link toc-highlight">Example module block</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Made by HackIT.</div></div></div></footer></div>
<script src="/Data-Platform-Playbook/assets/js/runtime~main.805040e5.js"></script>
<script src="/Data-Platform-Playbook/assets/js/main.f7d52c65.js"></script>
</body>
</html>