<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="search" type="application/opensearchdescription+xml" title="Hackney Data Platform Playbook" href="/Data-Platform-Playbook/opensearch.xml"><title data-react-helmet="true">Ingest manually uploaded csv files | Hackney Data Platform Playbook</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://playbook.hackney.gov.uk//Data-Platform-Playbook/playbook/ingesting-data/manual-ingest-of-csv-files"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Ingest manually uploaded csv files | Hackney Data Platform Playbook"><meta data-react-helmet="true" name="description" content="Ingest data from csv files"><meta data-react-helmet="true" property="og:description" content="Ingest data from csv files"><link data-react-helmet="true" rel="shortcut icon" href="/Data-Platform-Playbook/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://playbook.hackney.gov.uk//Data-Platform-Playbook/playbook/ingesting-data/manual-ingest-of-csv-files"><link data-react-helmet="true" rel="alternate" href="https://playbook.hackney.gov.uk//Data-Platform-Playbook/playbook/ingesting-data/manual-ingest-of-csv-files" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://playbook.hackney.gov.uk//Data-Platform-Playbook/playbook/ingesting-data/manual-ingest-of-csv-files" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/Data-Platform-Playbook/assets/css/styles.1180568a.css">
<link rel="preload" href="/Data-Platform-Playbook/assets/js/runtime~main.63b814e9.js" as="script">
<link rel="preload" href="/Data-Platform-Playbook/assets/js/main.a457e2a7.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Data-Platform-Playbook/"><img src="/Data-Platform-Playbook/img/logo-long.svg" alt="Data Platform Playbook" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/Data-Platform-Playbook/img/logo-long.svg" alt="Data Platform Playbook" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Data Platform Playbook</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/LBHackney-IT/data-platform-playbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">About</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Playbook</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Getting set up on the platform</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Finding data on the platform</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Getting access to data</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Ingesting data</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/google-sheets-import">Ingesting data from Google Sheets</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/manual-ingest-of-csv-files">Ingest manually uploaded csv files</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/ingest-xlsx-files-from-g-drive">Ingest XLXS files from G Drive</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/ingesting-rds-snapshot-in-landing-zone">Ingesting RDS snapshot into the Data Platform Landing Zone</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/database-ingestion">Ingesting data from databases into the Data Platform</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Transforming data</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Querying and analysing data</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Technical Documentation</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Architecture Decision</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Spikes</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/Data-Platform-Playbook/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/Data-Platform-Playbook/roles">Roles</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Ingest manually uploaded csv files</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="prerequisites"></a>Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">#</a></h2><ul><li>You have some structured data files you wish to have available from the Data Platform</li><li>You have access to the Hackney Data Platform</li><li>The department you are placing this data into the data platform has the manual CSV upload
functionality enabled.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="steps"></a>Steps<a class="hash-link" href="#steps" title="Direct link to heading">#</a></h2><ul><li><p>Ensure your data meets the following requirments before proceeding.</p><ul><li>You have saved the data as a &quot;CSV&quot; file format, using a comma to separate fields.
When <a href="https://docs.workstars.com/en/latest/howto/save-csv-utf8.html" target="_blank" rel="noopener noreferrer">exporting from Excel</a>, select the &quot;CSV UTF-8&quot; option.</li><li>The first row of the CSV contains the names of the columns as you wish them
to appear within the Data Platform.
If there are any empty rows before the column names delete them before exporting
the file.</li></ul></li><li><p>Sign in to the AWS Management Console and open the <a href="https://console.aws.amazon.com/s3/" target="_blank" rel="noopener noreferrer">Amazon S3 console</a>.</p></li><li><p>In the Buckets list, select the landing zone bucket, at
<a href="https://s3.console.aws.amazon.com/s3/buckets/dataplatform-stg-landing-zone?region=eu-west-2&amp;tab=objects" target="_blank" rel="noopener noreferrer">dataplatform-stg-landing-zone</a>.
Navigate to your departments manual upload folder, see below for structure.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;department&gt;/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">â””â”€â”€ manual/</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><p>Inside of the manual folder, create a new folder for the dataset you wish to create inside the data platform.
The name of the folder you create here will be used as the table name for the datasource throughout the platform.
If you are appending data to an already existing dataset, you can skip this step.</p></li><li><p>Inside of your dataset folder, upload a CSV containing your dataset by clicking the &quot;Add files&quot; button
and selecting the local files you want to upload then afterwards click the &quot;Upload&quot; button.
Alternatively, you can use &quot;Add folder&quot; taking care not to have any files in your local folder that you do not want to upload.
Any CSVs uploaded within this folder will be combined into one dataset, and should have a matching set of columns.
The status of each file should say &quot;Upload succeeded&quot;, then click on the &quot;Close&quot; button.</p></li><li><p>Now go to <a href="https://eu-west-2.console.aws.amazon.com/glue/home?region=eu-west-2#etl:tab=jobs" target="_blank" rel="noopener noreferrer">AWS Glue Jobs</a>, where you will run the job called
<code>&lt;department&gt; copy manually uploaded CSVs to raw</code>.
Select this job and click the &quot;Run job&quot; option in the Action pull-down menu.
If a &quot;Parameters&quot; dialogue box appears then click &quot;Run job&quot;.</p></li><li><p>Reselect the Job, observe the progress of its run within the &quot;History&quot; tab, and wait
for the &quot;Run status&quot; to reach &quot;Succeeded&quot;.
This job will have created a S3 folder structure as shown below inside the <a href="/Data-Platform-Playbook/zones#raw-zone">Raw zone</a>
and an Apache Parquet file containing your CSV data inside of there.
You can check the output by navigating to S3 Bucket <a href="https://s3.console.aws.amazon.com/s3/buckets/dataplatform-stg-raw-zone?region=eu-west-2&amp;tab=objects" target="_blank" rel="noopener noreferrer">dataplatform-stg-raw-zone</a>,
confirming the folder structure, and observing that Apache Parquet file(s) have been created.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;department&gt;/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">â””â”€â”€ manual/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    â””â”€â”€ &lt;dataset-name&gt;/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        â””â”€â”€ import_year=&lt;year&gt;/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            â””â”€â”€ import_month=&lt;month&gt;/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                â””â”€â”€ import_day=&lt;day&gt;/</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    â””â”€â”€ import_date=&lt;YYYYMMDD&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        â””â”€â”€ part-xxxxx-xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx.xxxx.snappy.parquet</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ul><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>Files uploaded to the CSV folder will only be copied over to the raw zone once.</p><p>The job uses the CSVs &quot;created at&quot; timestamp to process only the CSVs which have been uploaded since the last time the job successfully ran.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="confirm-the-ingestion-worked"></a>Confirm the ingestion worked<a class="hash-link" href="#confirm-the-ingestion-worked" title="Direct link to heading">#</a></h2><p>Next we&#x27;ll confirm the data has been ingested correctly by crawling the data with
<a href="https://eu-west-2.console.aws.amazon.com/glue/home?region=eu-west-2#catalog:tab=crawlers" target="_blank" rel="noopener noreferrer">AWS Glue Crawler</a> and then inspecting it within
<a href="/Data-Platform-Playbook/playbook/querying-and-analysing-data/querying-data-using-sql">AWS Athena</a>.</p><ul><li><p>Before accessing the data within Athena, you will need to run the crawler for this data.
Navigate to the <a href="https://eu-west-2.console.aws.amazon.com/glue/home?region=eu-west-2#catalog:tab=crawlers" target="_blank" rel="noopener noreferrer">AWS Glue Crawler</a> interface, select the crawler named <code>&lt;department&gt;-copy-manually-uploaded-csvs-to-raw</code>, then click on &quot;Run crawler&quot;.
Wait until its status returns to &quot;Ready&quot;.
Check the &quot;Last runtime&quot; of previous jobs to get an idea of how long you might have to wait.</p></li><li><p>Once crawled, there will be a newly created table within the database which you can access in <a href="https://eu-west-2.console.aws.amazon.com/athena/home?region=eu-west-2#query" target="_blank" rel="noopener noreferrer">Athena</a> as
<code>&lt;department&gt;-raw-zone</code>.
You should see a table eg. &quot;cake_designs&quot; with the column names as per the CSV header.
You should also see various &quot;import_...&quot; columns at the end some of which are marked (Partitioned).
You can then view the newly imported tables under the tables tab.
Note: The original names of the files, when they were uploaded, is not captured here at the moment.</p></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/Data-Platform-Playbook/tags/playbook">playbook</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/LBHackney-IT/data-platform-playbook/edit/master/docs/playbook/ingesting-data/002-manual-ingest-of-csv-files.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Data-Platform-Playbook/playbook/ingesting-data/google-sheets-import"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Ingesting data from Google Sheets</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Data-Platform-Playbook/playbook/ingesting-data/ingest-xlsx-files-from-g-drive"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Ingest XLXS files from G Drive Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link">Prerequisites</a></li><li><a href="#steps" class="table-of-contents__link">Steps</a></li><li><a href="#confirm-the-ingestion-worked" class="table-of-contents__link">Confirm the ingestion worked</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Made by HackIT.</div></div></div></footer></div>
<script src="/Data-Platform-Playbook/assets/js/runtime~main.63b814e9.js"></script>
<script src="/Data-Platform-Playbook/assets/js/main.a457e2a7.js"></script>
</body>
</html>