<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-playbook/ingesting-data/tips-on-how-to-write-an-API-Lambda-script">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<link rel="search" type="application/opensearchdescription+xml" title="Hackney Data Platform Playbook" href="/Data-Platform-Playbook/opensearch.xml"><title data-rh="true">Tips on writing an API Ingestion script for AWS Lambda | Hackney Data Platform Playbook</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://playbook.hackney.gov.uk//Data-Platform-Playbook/playbook/ingesting-data/tips-on-how-to-write-an-API-Lambda-script"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Tips on writing an API Ingestion script for AWS Lambda | Hackney Data Platform Playbook"><meta data-rh="true" name="description" content="Recommendations to write an API ingestion script for a Lambda in the Data Platform"><meta data-rh="true" property="og:description" content="Recommendations to write an API ingestion script for a Lambda in the Data Platform"><link data-rh="true" rel="icon" href="/Data-Platform-Playbook/img/favicon.png"><link data-rh="true" rel="canonical" href="https://playbook.hackney.gov.uk//Data-Platform-Playbook/playbook/ingesting-data/tips-on-how-to-write-an-API-Lambda-script"><link data-rh="true" rel="alternate" href="https://playbook.hackney.gov.uk//Data-Platform-Playbook/playbook/ingesting-data/tips-on-how-to-write-an-API-Lambda-script" hreflang="en"><link data-rh="true" rel="alternate" href="https://playbook.hackney.gov.uk//Data-Platform-Playbook/playbook/ingesting-data/tips-on-how-to-write-an-API-Lambda-script" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://KNMFHOJ4X2-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/Data-Platform-Playbook/assets/css/styles.4438b1b5.css">
<link rel="preload" href="/Data-Platform-Playbook/assets/js/runtime~main.30368a4b.js" as="script">
<link rel="preload" href="/Data-Platform-Playbook/assets/js/main.99d15bef.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Data-Platform-Playbook/"><div class="navbar__logo"><img src="/Data-Platform-Playbook/img/logo-long.svg" alt="Data Platform Playbook" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/Data-Platform-Playbook/img/logo-long.svg" alt="Data Platform Playbook" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title text--truncate">Data Platform Playbook</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/LBHackney-IT/data-platform-playbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_dLyj"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_mKqt"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><div class="docPage_ualW"><aside class="theme-doc-sidebar-container docSidebarContainer_UQUJ"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/Data-Platform-Playbook/playbook/getting-set-up">Playbook</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/getting-set-up">Getting set up on the platform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/elements-of-the-platform/data-catalogue">Elements of the platform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/finding-data/data-catalogue">Finding data on the platform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/getting-access-to-data/Tableau-to-redshift">Getting access to data</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/what-data-are-we-ingesting">Ingesting data</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/what-data-are-we-ingesting">Types of data and ingestion process</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/google-sheets-import">Ingesting data from Google Sheets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/manual-ingest-of-csv-files">Ingest manually uploaded csv files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/ingest-spreadsheet-files-from-g-drive">Ingest spreadsheet files from G Drive</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/ingesting-rds-snapshot-in-landing-zone">Ingesting RDS snapshot into the Data Platform Landing Zone</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/database-ingestion">Ingesting data from databases into the Data Platform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/ingesting-dynamo-db-tables">Ingesting Dynamo DB tables into the Landing Zone</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/event-streaming">Ingesting new data entities via event streaming</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/ingesting-api-data">Ingesting data from an API to the Data Platform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/production-to-pre-production-sync">Production to pre-production data sync</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/tips-on-how-to-write-an-API-Lambda-script">Tips on writing an API Ingestion script for AWS Lambda</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/transforming-data/guides-to-testing-in-the-platform/data-quality-testing-guide">Transforming data</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/querying-and-analysing-data/connecting-to-redshift-from-data-studio">Querying and analysing data</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/training-modules/module-0">Training Modules</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/docs/CD-process">Technical Documentation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/architecture-decisions">Architecture Decision</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/spikes/amundsen-deployment">Spikes</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Data-Platform-Playbook/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Data-Platform-Playbook/roles">Roles</a></li></ul></nav></div></aside><main class="docMainContainer_uL0j"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/Data-Platform-Playbook/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_kU5B"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Playbook</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Ingesting data</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Tips on writing an API Ingestion script for AWS Lambda</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_bZGK theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_l22C">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Tips on writing an API Ingestion script for AWS Lambda</h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">​</a></h2><ul><li>Have the secrets/api_key stored in both Production and Pre-Production environments, with the naming convention of &quot;/<!-- -->[Department Name]<!-- -->/<!-- -->[secret name]<!-- -->&quot;. So for example, /customer-services/vonage</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h2><p>This is an article on tips to write, format your Python script, to be used in Lambda for the Data Platform. </p><h2 class="anchor anchorWithStickyNavbar_mojV" id="writing-the-code-for-the-data-platform">Writing the Code for the Data Platform<a class="hash-link" href="#writing-the-code-for-the-data-platform" title="Direct link to heading">​</a></h2><p>You can use whatever you want to make the Python Script. However to have it run in the Data Platform, there are a few rules to keep in mind if you intend for this script to be used in AWS Lambda.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="desired-end-output">Desired End Output<a class="hash-link" href="#desired-end-output" title="Direct link to heading">​</a></h3><ul><li>.Py File</li><li>Code which can be run frequently. Lambdas have a timeout limit of 15 minutes, so the code must complete within this time. It&#x27;s therefore likely you&#x27;ll want your code to run daily.</li><li>Outputs the <strong>RAW CONTENT</strong> of the API call. No transformations</li><li>Outputs the content in <code> {folder}/import_year={year}/import_month={month}/import_day={day}/import_date={date}/</code></li><li>The dates refer to the date of import, not the date of the Data</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="basic-rules">Basic Rules<a class="hash-link" href="#basic-rules" title="Direct link to heading">​</a></h3><ol><li>The Python Script needs to be able to determine, on its own, which date range to pull data from</li><li>The Lambda will run the &quot;Lambda_handler&quot; function. This means in place of <code>__MAIN__()</code> you will have <code>def lambda_handler(event, lambda_context):</code>. Then to run this script, you just have a <code>lambda_handler(&quot;&quot;,&quot;&quot;)</code> line</li><li>If you have variables which you want the Terraform or Glue job to handle, you can pass them through as environment variables instead. <code>os.environ[&quot;TARGET_S3_BUCKET_NAME&quot;] = &quot;landing-zone&quot;</code>  for example will set the environment variable <code>TARGET_S3_BUCKET_NAME</code> to <code>landing-zone</code>. <code>s3_bucket = getenv(&quot;TARGET_S3_BUCKET_NAME&quot;)</code> Will then be the code to get the environment variable as a variable in your script</li><li>Have no secrets (e.g. API keys) hard coded into the script</li><li>Try to use as little external packages as possible, Pandas is around 50mb after you install all of the dependancies. Very expensive</li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="some-tips">Some tips<a class="hash-link" href="#some-tips" title="Direct link to heading">​</a></h3><ul><li>If you are coding using .py files, the way I have found to code the script is to have 2 separate scripts. One main.py file which has the code to go into the Lambda. Another script which triggers that one and sets environment variables - In Jupyter (So Google Colab). Instead of making multiple scripts, use multiple cells. This is what I would suggest<ul><li>Import cell</li><li>Functions cell</li><li><code>lambda_handler(event, lambda_context):</code> which acts as your main(), and interacts with the functions cell</li><li>A cell with lambda_handler(&quot;&quot;,&quot;&quot;) and environment variable setters to trigger above. This will not be copied into your .py script when it comes down to making it in the Data Platform but it&#x27;s what will help trigger your Lambda Handler event</li></ul></li></ul><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Example Jupyter Script Format</summary><div><div class="collapsibleContent_i85q"><p></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import os</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">def print_text(text_string):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    print(text_string)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">def lambda_handler(event, lambda_context):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    load_dotenv() # load environment variables</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    string_to_print = getenv(&quot;STRING_TO_PRINT&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    print_text(string_to_print)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import os</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">os.environ[&quot;STRING_TO_PRINT&quot;] = &quot;Bacon&quot; # Variable to be passed via Terraform</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lambda_handler(&quot;&quot;,&quot;&quot;)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p></p></div></div></details><p>Once you have your script able to output data from the API locally, we need to modify the script to output to S3.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="integrating-s3">Integrating S3<a class="hash-link" href="#integrating-s3" title="Direct link to heading">​</a></h2><p>For our Python script to output data into the Data Platform, we will use a Python Module called <a href="https://boto3.amazonaws.com/v1/documentation/api/1.9.42/index.html#:~:text=Boto%203%20Documentation%C2%B6%20Boto%20is%20the%20Amazon%20Web,to%20use%2C%20object-oriented%20API%20as%20well%20as%20low-level" target="_blank" rel="noopener noreferrer">Boto3</a></p><p>While it has many features, we will focus on 3 of them</p><ul><li>Obtaining secrets from Secrets Manager</li><li>Reading files in S3 Bucket</li><li>Outputting to S3</li></ul><p>However Boto3 does not work unless you authenticate Boto3. There are many ways to do so, follow one of these methods found <a href="https://boto3.amazonaws.com/v1/documentation/api/1.9.42/guide/configuration.html#guide-configuration" target="_blank" rel="noopener noreferrer">Here</a></p><p>Once you have authenticated Boto3. Lets use some AWS functionality</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="obtaining-secrets-from-the-secrets-manager">Obtaining Secrets from the Secrets Manager<a class="hash-link" href="#obtaining-secrets-from-the-secrets-manager" title="Direct link to heading">​</a></h3><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Code to get Secrets from S3</summary><div><div class="collapsibleContent_i85q"><p></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">secrets_manager_client = boto3.client(&#x27;secretsmanager&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">secret_name = getenv(&quot;SECRET_NAME&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">secret_manager_response = secrets_manager_client.get_secret_value(SecretId=secret_name)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">api_credentials = json.loads(secret_manager_response[&#x27;SecretString&#x27;])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">api_key = api_credentials.get(&quot;api_key&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">secret = api_credentials.get(&quot;secret&quot;)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p></p></div></div></details><ol><li>Create a secrets manager client with boto3</li><li>Pull the secret_name from environment variables. </li></ol><ul><li>In local environment we can give this to the script using <code>os.environ[&quot;SECRET_NAME&quot;] = &quot;Some Value&quot;</code>. </li><li>In the Data Platform, we will give the secret name to the script via Terraform later</li></ul><ol start="3"><li>Make an API request to the Secrets Manager client, this will return a response</li><li>Load the Secret String portion of the response <!-- -->[&#x27;SecretString&#x27;]</li><li>Get the API Key and Secret</li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="reading-files-in-s3-bucket">Reading files in S3 Bucket<a class="hash-link" href="#reading-files-in-s3-bucket" title="Direct link to heading">​</a></h3><p>You may want to read what files that you have in an S3 Bucket, maybe to determine what data you already have, or maybe to actually read one</p><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Code to List folders</summary><div><div class="collapsibleContent_i85q"><p></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">s3_client = boto3.client(&#x27;s3&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def list_subfolders_in_directory(s3_client,bucket,directory):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        response = s3_client.list_objects_v2(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                Bucket=bucket,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                Prefix=directory,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                Delimiter=&quot;/&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        subfolders = response.get(&#x27;CommonPrefixes&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return subfolders</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p></p></div></div></details><p>Returns a list of folders at a specific path.</p><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Code to List Files</summary><div><div class="collapsibleContent_i85q"><p></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">s3_client = boto3.client(&#x27;s3&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bucket = &quot;Bucket name&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">directory = &quot;Path to where you want to list the files, ending with /&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def list_s3_files_in_folder_using_client(s3_client,bucket,directory):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    response = s3_client.list_objects_v2(Bucket=bucket, Prefix=directory)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    files = response.get(&quot;Contents&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    for file in files:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        file[&#x27;Key&#x27;] = re.sub(string=file[&#x27;Key&#x27;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       pattern=f&quot;{directory}/&quot;.format(),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       repl=&quot;&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # returns a list of dictionaries with file metadata</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return files</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p></p></div></div></details><p>Returns a list of files at a specific path.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="output-to-s3-landing-zone">Output to S3 Landing Zone<a class="hash-link" href="#output-to-s3-landing-zone" title="Direct link to heading">​</a></h3><p>Here I will supply and explain two functions which will help you put files into S3</p><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Output to Landing zone with Formatting</summary><div><div class="collapsibleContent_i85q"><p></p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#bfc7d5"><span class="token plain">from datetime import date</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def output_to_landing_zone(s3_bucket, data, output_folder,filename):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        todays_date = date.today()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        day = todays_date.day.zfill(2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        month = todays_date.month.zfill(2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        year = str(todays_date.year)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return s3_client.put_object(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                Bucket=s3_bucket,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                Body=str(data),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                Key=f&quot;{output_folder}/import_year={year}/import_month={month}/import_day={day}/import_date={todays_date}/{filename}.json&quot;)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p></p></div></div></details><p>So if you wanted to put a json file into the &quot;<strong>Sandbox</strong>&quot; bucket, and within that bucket, you want the data to be within the &quot;<strong>CRM</strong>&quot; folder, you would call the function with</p><p><code>output_to_landing_zone(s3_bucket, &lt;the json data&gt;, &quot;**CRM**&quot;, &quot;**Sandbox**&quot;). </code></p><p>It will then proceed to put the Data into the Data Platform. It will use today as the import day and create the correct folder structure for it to work. Note that the import_date is in YYYYMMDD format not YYYY-MM-DD</p><p>Once you get the code, try running the code using Pre-Prod credentials to output to Pre-Prod</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="generating-a-piplock-and-requirementstxt-file">Generating a Piplock and Requirements.txt File<a class="hash-link" href="#generating-a-piplock-and-requirementstxt-file" title="Direct link to heading">​</a></h2><p>For your Python script to work, you will most likely need to download extra packages to use, packages which are not built in to Python</p><p>To do this, we will create a requirements.txt file, and from the requirements.txt file, we will generate a Piplock file. This Piplock file is what tells the Terraform (Which creates Lambdas) which external packages to give to the environment which will run your Python Script</p><ol><li>Install Pipreqs</li></ol><p>Generally something like <code>pip install pipreqs</code> would be fine</p><ol start="2"><li>Open command prompt at the location of your Python Script</li><li>Use the command <code>pipreqs</code></li></ol><p>This creates a <code>requirements.txt</code> file. It contains all of the packages and dependancies you need for your script</p><ol start="4"><li>Install Pipenv</li></ol><p><code>pip install pipenv</code> works</p><ol start="5"><li>Use the command <code>pipenv lock</code></li></ol><p>This will now create a <code>pipfile</code> and <code>pipfile.lock</code>. These are what the Terraform needs to create your Lambda. </p><ol start="6"><li>Open your <code>pipfile</code>. </li><li>Move boto3 and botocore rows to <code>[dev-packages]</code></li><li>Replace the contents of all of the package versions with &quot;*&quot; instead</li></ol><p>For example. <code>boto3 = &quot;==1.24.89&quot;</code> would become <code>boto3 = &quot;*&quot;</code> instead</p><ol start="9"><li>Change the python version to &quot;3&quot;</li></ol><p>So now we have a script which outputs files into AWS S3, we have the piplock file which lets the Terraform know what packages we need. We now need to push the script to the dataplatform so that we can begin to use it</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="update-the-data-platform-with-our-script">Update the Data Platform with our Script<a class="hash-link" href="#update-the-data-platform-with-our-script" title="Direct link to heading">​</a></h2><p>The best practise way is to clone the project into your IDE, create the files in the right place, then push it back to the Data Platform to be merged into the main branch</p><ol><li>If you do not have a copy of the Data Platform in your IDE environment already, clone the Data Platform</li><li>Navigate to <code>lambdas</code></li><li>Create a folder for your script. Named something like <code>something_api_ingestion</code>. All lowercase and underscores replacing spaces</li><li>Either create or copy your <code>main.py</code> script in this folder. Do the same with the <code>pipfile</code> and <code>pipfile.lock</code>. </li><li>Commit and Push into the Data Platform, then make a Pull Request. Your code will need to be reviewed by someone else before it can be put into Live.</li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/Data-Platform-Playbook/tags/playbook">playbook</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/LBHackney-IT/data-platform-playbook/edit/master/docs/playbook/ingesting-data/011-tips-on-how-to-write-an-API-Lambda-script.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/Data-Platform-Playbook/playbook/ingesting-data/production-to-pre-production-sync"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Production to pre-production data sync</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Data-Platform-Playbook/playbook/transforming-data/guides-to-testing-in-the-platform/data-quality-testing-guide"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Guide to testing data quality in Glue Jobs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#writing-the-code-for-the-data-platform" class="table-of-contents__link toc-highlight">Writing the Code for the Data Platform</a><ul><li><a href="#desired-end-output" class="table-of-contents__link toc-highlight">Desired End Output</a></li><li><a href="#basic-rules" class="table-of-contents__link toc-highlight">Basic Rules</a></li><li><a href="#some-tips" class="table-of-contents__link toc-highlight">Some tips</a></li></ul></li><li><a href="#integrating-s3" class="table-of-contents__link toc-highlight">Integrating S3</a><ul><li><a href="#obtaining-secrets-from-the-secrets-manager" class="table-of-contents__link toc-highlight">Obtaining Secrets from the Secrets Manager</a></li><li><a href="#reading-files-in-s3-bucket" class="table-of-contents__link toc-highlight">Reading files in S3 Bucket</a></li><li><a href="#output-to-s3-landing-zone" class="table-of-contents__link toc-highlight">Output to S3 Landing Zone</a></li></ul></li><li><a href="#generating-a-piplock-and-requirementstxt-file" class="table-of-contents__link toc-highlight">Generating a Piplock and Requirements.txt File</a></li><li><a href="#update-the-data-platform-with-our-script" class="table-of-contents__link toc-highlight">Update the Data Platform with our Script</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Made by HackIT.</div></div></div></footer></div>
<script src="/Data-Platform-Playbook/assets/js/runtime~main.30368a4b.js"></script>
<script src="/Data-Platform-Playbook/assets/js/main.99d15bef.js"></script>
</body>
</html>