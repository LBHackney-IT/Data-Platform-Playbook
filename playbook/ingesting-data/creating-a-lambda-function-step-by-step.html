<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-playbook/ingesting-data/creating-a-lambda-function-step-by-step">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">How to create a Lambda function for data ingestion on the Data Analytics Platform | Hackney Data Platform Playbook</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://playbook.hackney.gov.uk/Data-Platform-Playbook/playbook/ingesting-data/creating-a-lambda-function-step-by-step"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="How to create a Lambda function for data ingestion on the Data Analytics Platform | Hackney Data Platform Playbook"><meta data-rh="true" name="description" content="Ingesting data using AWS Lambda [step-by-step]"><meta data-rh="true" property="og:description" content="Ingesting data using AWS Lambda [step-by-step]"><link data-rh="true" rel="icon" href="/Data-Platform-Playbook/img/favicon.png"><link data-rh="true" rel="canonical" href="https://playbook.hackney.gov.uk/Data-Platform-Playbook/playbook/ingesting-data/creating-a-lambda-function-step-by-step"><link data-rh="true" rel="alternate" href="https://playbook.hackney.gov.uk/Data-Platform-Playbook/playbook/ingesting-data/creating-a-lambda-function-step-by-step" hreflang="en"><link data-rh="true" rel="alternate" href="https://playbook.hackney.gov.uk/Data-Platform-Playbook/playbook/ingesting-data/creating-a-lambda-function-step-by-step" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://KNMFHOJ4X2-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Hackney Data Platform Playbook" href="/Data-Platform-Playbook/opensearch.xml"><link rel="stylesheet" href="/Data-Platform-Playbook/assets/css/styles.e0b8b3cc.css">
<link rel="preload" href="/Data-Platform-Playbook/assets/js/runtime~main.efd05c05.js" as="script">
<link rel="preload" href="/Data-Platform-Playbook/assets/js/main.aed49b4a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Data-Platform-Playbook/"><div class="navbar__logo"><img src="/Data-Platform-Playbook/img/logo-long.svg" alt="Data Platform Playbook" class="themedImage_ToTc themedImage--light_HNdA"><img src="/Data-Platform-Playbook/img/logo-long.svg" alt="Data Platform Playbook" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Data Platform Playbook</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/LBHackney-IT/data-platform-playbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/">About</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/Data-Platform-Playbook/playbook/getting-set-up">Playbook</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/getting-set-up">Getting set up on the platform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/elements-of-the-platform/data-catalogue">Elements of the platform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/finding-data/data-catalogue">Finding data on the platform</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/getting-access-to-data/Tableau-to-redshift">Getting access to data</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/what-data-are-we-ingesting">Ingesting data</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/what-data-are-we-ingesting">Types of data and ingestion process</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/google-sheets-import">Ingesting data from Google Sheets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/manual-ingest-of-csv-files">Ingest manually uploaded csv files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/ingest-spreadsheet-files-from-g-drive">Ingest spreadsheet files from G Drive</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/ingesting-rds-snapshot-in-landing-zone">Ingesting RDS snapshot into the Data Platform Landing Zone</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/database-ingestion">Ingesting data from databases into the Data Platform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/ingesting-dynamo-db-tables">Ingesting Dynamo DB tables into the Landing Zone</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/event-streaming">Ingesting new data entities via event streaming</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/ingesting-api-data">Ingesting data from an API to the Data Platform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/production-to-pre-production-sync">Production to pre-production data sync</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/tips-on-how-to-write-an-API-Lambda-script">Tips on writing an API Ingestion script for AWS Lambda</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/using-watermarks-to-record-job-states">Using Watermarks to Record AWS GLue Job States Between Runs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Data-Platform-Playbook/playbook/ingesting-data/creating-a-lambda-function-step-by-step">How to create a Lambda function for data ingestion on the Data Analytics Platform</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/transforming-data/guides-to-testing-in-the-platform/data-quality-testing-guide">Transforming data</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/Data-Platform-Playbook/playbook/querying-and-analysing-data/time-series-analysis/introduction">Querying and analysing data</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/training-modules/module-0">Training Modules</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/docs/CD-process">Technical Documentation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/dap-airflow/introduction">DAPâ‡¨flow</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/architecture-decisions">Architecture Decision</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Data-Platform-Playbook/spikes/amundsen-deployment">Spikes</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Data-Platform-Playbook/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Data-Platform-Playbook/roles">Roles</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/Data-Platform-Playbook/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Playbook</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Ingesting data</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">How to create a Lambda function for data ingestion on the Data Analytics Platform</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>How to create a Lambda function for data ingestion on the Data Analytics Platform</h1><h3 class="anchor anchorWithStickyNavbar_LWe7" id="check-the-feasibility-of-a-lambda-function-approach">Check the feasibility of a Lambda function approach<a href="#check-the-feasibility-of-a-lambda-function-approach" class="hash-link" aria-label="Direct link to Check the feasibility of a Lambda function approach" title="Direct link to Check the feasibility of a Lambda function approach">â€‹</a></h3><p>Before starting, it is advisable to discuss with the DAP team that a Lambda function is the most appropriate approach to take for your data ingestion task.</p><p>Here are some factors to consider before proceeding:</p><ul><li><p><em>Execution Time</em></p><p>  Lambda functions have execution time limits (currently 15 minutes per invocation). Ensure that your workload can execute within this time limit. If not, have a discussion with the DAP team to identify a more suitable approach.</p></li></ul><ul><li><p><em>Supported Runtimes and dependencies</em></p><p>  Lambda supports multiple programming languages including Python. Certain Python packages may need to be imported. This can be achieved through Lambda layers.</p></li></ul><ul><li><em>Monitoring</em>  Lambda integrates with <a href="https://docs.aws.amazon.com/lambda/latest/dg/monitoring-cloudwatchlogs.html" target="_blank" rel="noopener noreferrer">AWS CloudWatch</a> for logging and monitoring; ensure that the permissions set includes the ability to write logs for debugging later on.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="outline-what-you-need-your-lambda-function-to-do">Outline what you need your Lambda function to do<a href="#outline-what-you-need-your-lambda-function-to-do" class="hash-link" aria-label="Direct link to Outline what you need your Lambda function to do" title="Direct link to Outline what you need your Lambda function to do">â€‹</a></h3><p>On the Data Analytics Platform, we typically use <a href="https://docs.aws.amazon.com/lambda/latest/dg/welcome.html" target="_blank" rel="noopener noreferrer">AWS Lambda</a> to perform simple ingestion and data processing tasks which do not require the resource-intensive infrastructure of an <a href="https://docs.aws.amazon.com/glue/latest/dg/what-is-glue.html" target="_blank" rel="noopener noreferrer">AWS Glue job</a>, for example:</p><ul><li>Making an <em>API call</em> and writing the response to the landing zone, including a crawler execution</li><li><em>Reading</em> in data from a <em>Google Sheet</em></li><li><em>Moving data</em> from one zone to another zone, with a simple refinement</li><li><em>Event-driven</em> processing, for example once new data arrives in S3, a Lambda is triggered to perform a task immediately</li><li>Near <em>Real-time processing</em> for example, when a new person is added to a permissions group, a Lambda is triggered to grant this permission</li></ul><p>If your process involves reading in very large datasets, applying complex algorithms using Spark or and undertaking data transformations with multiple datasets, then this might be better suited to a different approach such as AWS Glue. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="requesting-the-correct-permissions-set">Requesting the correct permissions set<a href="#requesting-the-correct-permissions-set" class="hash-link" aria-label="Direct link to Requesting the correct permissions set" title="Direct link to Requesting the correct permissions set">â€‹</a></h3><p>You will need to provide the DAP team with the following information so that the correct roles and policies can be set up for your Lambda. At the time of writing it is advisable to set up a short meeting with the DAP team to discuss your requirements : </p><ol><li>The department or service area that the process is for e.g. <em>Housing</em></li><li>Where data will be ingested / read from e.g. <em>an external API; housing-zone-raw database</em></li><li>Where data needs to be written to e.g. <em>landing zone, refined zone</em></li><li>The kind of actions that needed e.g. writing data to S3 <em>s3:PutObject</em></li><li>Whether <em>logging</em> is to be enabled</li><li>Whether secrets needs to be accessed from <em>AWS Secret Manager</em> (and what the secrets are called)</li><li>Any other services needed for your Lambda task e.g. <em>AWS Glue Crawler</em> <em>StartCrawler</em> action</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="python-packages-and-lambda-layers">Python packages and Lambda layers<a href="#python-packages-and-lambda-layers" class="hash-link" aria-label="Direct link to Python packages and Lambda layers" title="Direct link to Python packages and Lambda layers">â€‹</a></h3><p>Python packages can be imported in the usual way within your script, but will need to be made available to the Lambda function, usually by including within a zip file.</p><p>An alternative method is to use <a href="https://docs.aws.amazon.com/lambda/latest/dg/chapter-layers.html" target="_blank" rel="noopener noreferrer">Lambda layers</a> which are where a package (or data) can be stored within a zip file and made available to all organisational users on the AWS environment (our Data Analytics Platform). Some common packages such as pandas are already <a href="https://aws-sdk-pandas.readthedocs.io/en/stable/layers.html" target="_blank" rel="noopener noreferrer">made available by AWS</a> (for specific Python versions), but other packages can be added to the DAP using this <a href="https://docs.google.com/document/d/17d9YiCmZRYb2eH2ATkMcPBm97IajdkP9ieY8XtzSxyQ/edit#heading=h.zao8k5xrsbng" target="_blank" rel="noopener noreferrer">method</a>.</p><p>The advantages of using Lambda layers is that the overall deployment package will be smaller due to fewer dependencies as well as avoiding Lambdas importing the same packages in isolation. Having a smaller deployment package means that code can be tested and debugged more easily in the AWS Lambda console as it wonâ€™t need to be zipped up.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-lambda-function">Creating a Lambda Function<a href="#creating-a-lambda-function" class="hash-link" aria-label="Direct link to Creating a Lambda Function" title="Direct link to Creating a Lambda Function">â€‹</a></h3><p><em>Introduction</em></p><p>There is a good example of a simple Lambda function on the AWS website <a href="https://docs.aws.amazon.com/lambda/latest/dg/getting-started.html" target="_blank" rel="noopener noreferrer">here</a>. This guide demonstrates how to use the AWS Console to build, deploy and test a simple Lambda function. It is recommended to read this first before trying to build your own Lambda function.</p><p><em>Developing your own Lambda function</em></p><ol><li>Create and checkout a new git branch, giving it a name that is prefixed with the Jira card ID e.g. <code>di-001-my-amazing-api-ingestion-for-housing</code>. This will ensure that any code commits and deployments are linked to the Jira agile workflow.</li></ol><ol start="2"><li>Ensure that you have the required roles and policies <a href="#requesting-the-correct-permissions-set">set up</a>. If these are new roles and / or policies then they will likely be set up on a Terraform script by the DAP team. If you are using an existing role then you can create an empty Terraform file in the <code>Terraform &gt; ETL</code> folder. Name the file in the same format as existing files by adding a prefix with the next numerical value e.g. <code>53-aws-lambda-my-amazing-ingestion.tf</code></li></ol><p><img loading="lazy" src="/Data-Platform-Playbook/assets/images/new-terraform-file-507659f1f692e0ec9964c6dad1189087.png" width="888" height="1268" class="img_ev3q"></p><ol start="3"><li>Once you are ready to start developing your Lambda function you will need to navigate to the <code>lambdas folder</code> in your <a href="https://playbook.hackney.gov.uk/Data-Platform-Playbook/playbook/getting-set-up/local-pyspark-environment" target="_blank" rel="noopener noreferrer">local environment</a>. </li></ol><ol start="4"><li>Create a new folder and give it a name that describes what it is doing e.g. <code>my-amazing-api-ingestion-for-housing</code></li></ol><p><img loading="lazy" src="/Data-Platform-Playbook/assets/images/new-lambda-folder-03c0687004a4abea66cf91c295e96594.png" width="734" height="1338" class="img_ev3q"></p><ol start="5"><li>Create a new empty Python file called <code>main.py</code>.</li></ol><p>Below is an adapted <a href="https://github.com/LBHackney-IT/Data-Platform/blob/main/lambdas/govnotify_api_ingestion_repairs/main.py" target="_blank" rel="noopener noreferrer">example</a> from the Data Platform GitHub repository. The script includes some commonly used functions that perform certain actions such as getting a secret from <em>AWS Secrets Manager</em>, <em>adding date partitions</em> to a file path and <em>uploading a JSON string to an S3 bucket</em>.</p><p>Using this as a template, replace the script with your package imports, functions and code. Your main code needs to sit within the <code>lambda_handler(event, context)</code> function which is what the Lambda job will look for when it is deployed.</p><p>The environment variables will be fully configured within the Terraform script that is created later on. For now, add the environment variables needed.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">from datetime import datetime</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import logging</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from os import getenv</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import boto3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from botocore.exceptions import ClientError</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from notifications_python_client.notifications import NotificationsAPIClient</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Set up logging to track key stages of the Lambda job</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">logging.basicConfig(level=logging.INFO)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">logger = logging.getLogger(__name__)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># custom functions (add any custom functions here)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def get_api_secret(api_secret_name, region_name):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    session = boto3.session.Session()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    client = session.client(service_name=&quot;secretsmanager&quot;, region_name=region_name)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    try:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        get_secret_value_response = client.get_secret_value(SecretId=api_secret_name)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    except ClientError as e:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        raise e</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return get_secret_value_response[&quot;SecretString&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def upload_to_s3(s3_bucket_name, s3_client, file_content, file_name):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    try:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        s3_client.put_object(Bucket=s3_bucket_name, Key=file_name, Body=file_content)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        logger.info(f&quot;Uploaded {file_name} to S3&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    except Exception as e:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        logger.error(f&quot;Error uploading {file_name} to S3: {str(e)}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def prepare_json(response):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return json.dumps(response).encode(&#x27;utf-8&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def add_date_partition_key_to_s3_prefix(s3_prefix):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    t = datetime.today()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    partition_key = f&quot;import_year={t.strftime(&#x27;%Y&#x27;)}/import_month={t.strftime(&#x27;%m&#x27;)}/import_day={t.strftime(&#x27;%d&#x27;)}/import_date={t.strftime(&#x27;%Y%m%d&#x27;)}/&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return f&quot;{s3_prefix}{partition_key}&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># main lambda_handler function (main script goes here)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def lambda_handler(event, context):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    logger.info(f&quot;Set up S3 client...&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # setting up clients needed for the task</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    s3_client = boto3.client(&#x27;s3&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    glue_client = boto3.client(&#x27;glue&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # environment variables</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    api_secret_name = getenv(&quot;API_SECRET_NAME&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    region_name = getenv(&quot;AWS_REGION&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    output_s3_bucket = getenv(&quot;TARGET_S3_BUCKET&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    output_folder = getenv(&quot;TARGET_S3_FOLDER&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    crawler = getenv(&quot;CRAWLER_NAME&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # main script</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    api_secret_string = get_api_secret(api_secret_name, region_name)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    api_secret_json = json.loads(api_secret_string)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    api_key = api_secret_json.get(&quot;api_key_live&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    client = NotificationsAPIClient(api_key)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    response = client.get_all_notifications(include_jobs=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    output_folder_json = add_date_partition_key_to_s3_prefix(f&#x27;{output_folder}notifications/json/&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    json_str = prepare_json(response=response)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # upload the json string to S3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    upload_to_s3(output_s3_bucket, s3_client, json_str, f&#x27;{output_folder_json}notifications.json&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # crawl all the parquet data in S3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    glue_client.start_crawler(Name=f&#x27;{crawler}&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">if __name__ == &quot;__main__&quot;:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    lambda_handler(&quot;event&quot;, &quot;lambda_context&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="6"><li>Adding resources to the Terraform script</li></ol><p>At the very beginning of your Terraform script (this is the script we created in <em>step 2, 53-aws-lambda-my-amazing-ingestion.tf</em>) ensure that the following block has been included. This will ensure that the Lambda is initially only deployed to pre-prod.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">locals {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> amazing_api_ingestion_resource_count = local.is_live_environment &amp;&amp; !local.is_production_environment ? 1 : 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After the policy blocks within the Terraform script, add a <a href="https://github.com/LBHackney-IT/Data-Platform/tree/main/terraform/modules/aws-lambda" target="_blank" rel="noopener noreferrer">module block</a> for the main Lambda resource (which has been custom developed on the DAP). as well other resource blocks such as for an <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_event_target" target="_blank" rel="noopener noreferrer">EventBridge target</a> or an <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/glue_crawler" target="_blank" rel="noopener noreferrer">AWS Glue Crawler</a>.</p><p>Within the layers list within the module block, any AWS supplied or custom Lambda layers can be added (see image below). A full example can be seen <a href="https://github.com/LBHackney-IT/Data-Platform/blob/main/terraform/etl/48-lambda-gov-notify-ingestion.tf" target="_blank" rel="noopener noreferrer">here</a>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">module &quot;gov-notify-ingestion-housing-repairs&quot; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> count                          = local.create_govnotify_resource_count</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> source                         = &quot;../modules/aws-lambda&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> tags                           = module.tags.values</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> lambda_name                    = &quot;govnotify_api_ingestion_repairs&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> lambda_role_arn                = aws_iam_role.housing_gov_notify_ingestion[0].arn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> identifier_prefix              = local.short_identifier_prefix</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> handler                        = &quot;main.lambda_handler&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> lambda_artefact_storage_bucket = module.lambda_artefact_storage_data_source.bucket_id</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> s3_key                         = &quot;govnotify_api_ingestion_repairs.zip&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> lambda_source_dir              = &quot;../../lambdas/govnotify_api_ingestion_repairs&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> lambda_output_path             = &quot;../../lambdas/govnotify_api_ingestion_repairs.zip&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> runtime                        = &quot;python3.9&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> environment_variables          = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   API_SECRET_NAME  = &quot;housing/gov-notify_live_api_key&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   TARGET_S3_BUCKET = module.landing_zone_data_source.bucket_id</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   TARGET_S3_FOLDER = &quot;housing/govnotify/damp_and_mould/&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   CRAWLER_NAME     = &quot;${local.short_identifier_prefix}GovNotify Housing Repairs Landing Zone&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> layers = [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   &quot;arn:aws:lambda:eu-west-2:336392948345:layer:AWSSDKPandas-Python39:13&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   &quot;arn:aws:lambda:eu-west-2:${data.aws_caller_identity.data_platform.account_id}:layer:notifications-python-client-9-0-0-layer:1&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   &quot;arn:aws:lambda:eu-west-2:${data.aws_caller_identity.data_platform.account_id}:layer:urllib3-1-26-18-layer:1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="7"><li>Deploying and testing</li></ol><p>Stage, commit and push your new files to the repository. Check the results of the standard tests in the GitHub repository. </p><ol start="8"><li>Final deployment </li></ol><p>Once you are satisfied that your Lambda is working as intended, change the locals block in your existing Terraform script (53-aws-lambda-my-amazing-ingestion.tf) to the following, which will deploy to both pre-prod and production environments. </p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">locals {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> amazing_api_ingestion_resource_count = local.is_live_environment ? 1 : 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Ensure that any secrets used are available in the production environment AWS Secrets Manager.</p><p>Well done, you have successfully created a Lambda job! ðŸŽ‰</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Data-Platform-Playbook/tags/playbook">playbook</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/LBHackney-IT/data-platform-playbook/edit/master/docs/playbook/ingesting-data/013-creating-a-lambda-function-step-by-step.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/Data-Platform-Playbook/playbook/ingesting-data/using-watermarks-to-record-job-states"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Using Watermarks to Record AWS GLue Job States Between Runs</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Data-Platform-Playbook/playbook/transforming-data/guides-to-testing-in-the-platform/data-quality-testing-guide"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Guide to testing data quality in Glue Jobs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#check-the-feasibility-of-a-lambda-function-approach" class="table-of-contents__link toc-highlight">Check the feasibility of a Lambda function approach</a></li><li><a href="#outline-what-you-need-your-lambda-function-to-do" class="table-of-contents__link toc-highlight">Outline what you need your Lambda function to do</a></li><li><a href="#requesting-the-correct-permissions-set" class="table-of-contents__link toc-highlight">Requesting the correct permissions set</a></li><li><a href="#python-packages-and-lambda-layers" class="table-of-contents__link toc-highlight">Python packages and Lambda layers</a></li><li><a href="#creating-a-lambda-function" class="table-of-contents__link toc-highlight">Creating a Lambda Function</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Made by HackIT.</div></div></div></footer></div>
<script src="/Data-Platform-Playbook/assets/js/runtime~main.efd05c05.js"></script>
<script src="/Data-Platform-Playbook/assets/js/main.aed49b4a.js"></script>
</body>
</html>